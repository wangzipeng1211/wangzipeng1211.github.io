<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>算法交易和量化投资03 | Quant 4ever</title><meta name="keywords" content="算法交易和量化投资"><meta name="author" content="Eddie"><meta name="copyright" content="Eddie"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="3 配对交易（Pairs Trading）">
<meta property="og:type" content="article">
<meta property="og:title" content="算法交易和量化投资03">
<meta property="og:url" content="https://wangzipeng1211.github.io/2023/07/15/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/index.html">
<meta property="og:site_name" content="Quant 4ever">
<meta property="og:description" content="3 配对交易（Pairs Trading）">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wangzipeng1211.github.io/img/cover.png">
<meta property="article:published_time" content="2023-07-14T16:30:04.526Z">
<meta property="article:modified_time" content="2023-07-20T07:31:10.203Z">
<meta property="article:author" content="Eddie">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Quant">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wangzipeng1211.github.io/img/cover.png"><link rel="shortcut icon" href="/img/alpha.png"><link rel="canonical" href="https://wangzipeng1211.github.io/2023/07/15/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"该文章创建于","messageNext":"天前, 请以最新文章为主"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Eddie","link":"链接: ","source":"来源: Quant 4ever","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '算法交易和量化投资03',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-07-20 15:31:10'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/alpha.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">63</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Timeline</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> list</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Quant 4ever</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Timeline</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> list</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">算法交易和量化投资03</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-07-14T16:30:04.526Z" title="发表于 2023-07-15 00:30:04">2023-07-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-07-20T07:31:10.203Z" title="更新于 2023-07-20 15:31:10">2023-07-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/">量化交易</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/">算法交易和量化投资</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">17.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>82分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="算法交易和量化投资03"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="配对交易概念"><a class="markdownIt-Anchor" href="#配对交易概念"></a> 配对交易概念</h1>
<ul>
<li>通过寻找价格走势具有稳定关系的两只股票（或者其他金融资产），在他们价格偏离稳定关系时买入价格相对较低 、做空价格相对较高的股票，并在他们价格回归稳定关系时反向平仓操作的投资策略<br>
<img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/01.png" alt="01"></li>
<li>配对交易又被称之为价差交易或者统计套利交易（统计套利交易并不仅限于配对交易），是一种风险小、收益较稳定的市场中性策略。</li>
</ul>
<h1 id="配对交易策略"><a class="markdownIt-Anchor" href="#配对交易策略"></a> 配对交易策略</h1>
<ul>
<li>20世纪80年代，Morgan Stanley的数量交易员Nunzio Tartaglia成立的一个数量分析团队提出的一种市场中性投资策略，其成员主要是物理学家、数学家、以及计算机学家</li>
<li>是一种主要的统计套利(<a target="_blank" rel="noopener" href="https://book.douban.com/subject/5384911/">Statistical Arbitrage</a>)策略</li>
<li>特点
<ul>
<li>市场中性</li>
<li>均值回归</li>
</ul>
</li>
<li>最小距离法： Gatev,Goetzmann and Rouwenhorst (2006), <a target="_blank" rel="noopener" href="https://academic.oup.com/rfs/article/19/3/797/1646694">Pairs Trading: Performance of a Relative-Value Arbitrage Rule</a>.</li>
<li>协整法：Vidyamurthy (2004), <a target="_blank" rel="noopener" href="https://book.douban.com/subject/2774462/">Pairs Trading: Quantitative Methods and Analysis</a>.</li>
<li>随机价差法：Robert，Hoek and Malcolm (2005), <a target="_blank" rel="noopener" href="https://www.tandfonline.com/doi/full/10.1080/14697680500149370">Pairs Trading</a>.</li>
</ul>
<h1 id="股票对的选择"><a class="markdownIt-Anchor" href="#股票对的选择"></a> 股票对的选择</h1>
<p>将市场划分为多个子空间分别进行检索。下面介绍集中子空间配对的方法：</p>
<ol>
<li>行业内匹配<br>
选取同行业公司规模相近的股票进行配对，比如将银行业的上市公司股票进行两两配对。</li>
<li>产业链配对<br>
根据产业链，将同一条产业链内的上市公司股票进行配对，例如将某一手机生产公司与其上游手机摄像头生产公司进行配对。</li>
<li>财务管理配对<br>
从基本面分析的角度切入，挑选上市公司市盈率、负债率、产品种类等相近的股票进行配对，进而减少一些不必要的搜索成本。</li>
</ol>
<p>另一种情况是同一公司在不同的市场分别发行股票。</p>
<h1 id="最小距离法第一步-通过最小距离法挑选股票对"><a class="markdownIt-Anchor" href="#最小距离法第一步-通过最小距离法挑选股票对"></a> 最小距离法：第一步 通过最小距离法挑选股票对</h1>
<ul>
<li>基本思想：Gatev,Goetzmann and Rouwenhorst (2006)挑选二支股票的标准化价格偏差之平方和最小的股票对</li>
<li>设定股票池范围（例如某一行业，某一产业链等）和形成期<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">t=0,1,\cdots, T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span>：假设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>P</mi><mi>t</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">P_t^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>表示股票<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>在第<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span>天的价格</li>
<li>计算任意两只股票的“距离”：</li>
</ul>
<ol>
<li>计算标准化股票价格（累计收益率）</li>
</ol>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>p</mi><mo>^</mo></mover><mi>t</mi><mi>i</mi></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>τ</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msubsup><mi>r</mi><mi>t</mi><mi>i</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mtext> </mtext><msubsup><mi>r</mi><mi>t</mi><mi>i</mi></msubsup><mo>:</mo><mo>=</mo><mo stretchy="false">(</mo><msubsup><mi>P</mi><mi>t</mi><mi>i</mi></msubsup><mo>−</mo><msubsup><mi>P</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><msubsup><mi>P</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><mtext> </mtext><mi>t</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">\hat{p}_t^i=\sum_{\tau=1}^t (1+r_t^i),\ where \ r_t^i:=(P_t^i-P_{t-1}^i)/P_{t-1}^i, \ t=1,\cdots, T
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.121664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.047674em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7805610000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.1132em;">τ</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1246639999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1246639999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.179995em;vertical-align:-0.305331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"> </span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span></span></p>
<ol start="2">
<li>计算两只股票 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>的标准化价格偏差之平方和</li>
</ol>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>S</mi><msub><mi>D</mi><mrow><mi>X</mi><mo separator="true">,</mo><mi>Y</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mo stretchy="false">(</mo><msubsup><mover accent="true"><mi>p</mi><mo>^</mo></mover><mi>t</mi><mi>X</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>p</mi><mo>^</mo></mover><mi>t</mi><mi>Y</mi></msubsup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex"> SSD_{X,Y}=\sum_{t=1}^T (\hat{p}_t^X-\hat{p}_t^Y)^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>挑选标准化价格偏差之平方和最小的一批股票对（比如10对）</li>
</ul>
<h1 id="最小距离法第二步-设定交易规则"><a class="markdownIt-Anchor" href="#最小距离法第二步-设定交易规则"></a> 最小距离法：第二步 设定交易规则</h1>
<ul>
<li>计算形成期内标准化股票价差的均值和标准差</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>=</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mo stretchy="false">(</mo><msubsup><mover accent="true"><mi>p</mi><mo>^</mo></mover><mi>t</mi><mi>X</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>p</mi><mo>^</mo></mover><mi>t</mi><mi>Y</mi></msubsup><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext> </mtext><mi>σ</mi><mo>=</mo><msqrt><mrow><mfrac><mn>1</mn><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><mo stretchy="false">(</mo><msubsup><mover accent="true"><mi>p</mi><mo>^</mo></mover><mi>t</mi><mi>X</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>p</mi><mo>^</mo></mover><mi>t</mi><mi>Y</mi></msubsup><mo>−</mo><mi>μ</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">\mu=\frac{1}{T}\sum_{t=1}^T (\hat{p}_t^X-\hat{p}_t^Y),\ 
\sigma=\sqrt{\frac{1}{T-1}\sum_{t=1}^T (\hat{p}_t^X-\hat{p}_t^Y-\mu)^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.3231990000000007em;vertical-align:-1.267113em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0560860000000005em;"><span class="svg-align" style="top:-5.283199em;"><span class="pstrut" style="height:5.283199em;"></span><span class="mord" style="padding-left:1.056em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231309999999998em;"><span style="top:-2.454244em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24575599999999992em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">p</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231309999999998em;"><span style="top:-2.454244em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24575599999999992em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">μ</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-4.016086em;"><span class="pstrut" style="height:5.283199em;"></span><span class="hide-tail" style="min-width:0.742em;height:3.3631990000000003em;"><svg width="400em" height="3.3631990000000003em" viewbox="0 0 400000 3363" preserveaspectratio="xMinYMin slice"><path d="M702 80H400000v40H742v3229l-4 4-4 4c-.667.7
-2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1h-12l-28-84c-16.667-52-96.667
-294.333-240-727l-212 -643 -85 170c-4-3.333-8.333-7.667-13 -13l-13-13l77-155
 77-156c66 199.333 139 419.667 219 661 l218 661zM702 80H400000v40H742z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>开仓：在交易期，当标准化股票价差超过<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>+</mo><mn>1.5</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu+1.5\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>或者低于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>−</mo><mn>1.5</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu-1.5\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>开仓</li>
<li>平仓：在交易期，开仓后当标准化股票价差恢复到均值附近平仓（价差超过<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>+</mo><mn>1.5</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu+1.5\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>的开仓，当价差恢复到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>+</mo><mn>0.2</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu+0.2\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>平仓；价差超过<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>−</mo><mn>1.5</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu-1.5\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>的开仓，当价差恢复到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>−</mo><mn>0.2</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu-0.2\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>平仓）</li>
<li>止损：在交易期，开仓后当标准化股票价差突破<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>±</mo><mn>2.5</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu\pm 2.5\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>，平仓止损</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># os.chdir(r&#x27;f:\SJTU\大四上\算法交易和量化投资\03&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>(os.getcwd()) <span class="comment">#函数获取当前目录</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> math</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/02.png" alt="02"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最小距离法交易策略</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取形成期数据</span></span><br><span class="line">sh = pd.read_csv(<span class="string">&#x27;sh50p.csv&#x27;</span>, index_col=<span class="string">&#x27;Trddt&#x27;</span>)</span><br><span class="line">sh.index = pd.to_datetime(sh.index)</span><br><span class="line"></span><br><span class="line">formStart = <span class="string">&#x27;2014-01-01&#x27;</span></span><br><span class="line">formEnd = <span class="string">&#x27;2015-01-01&#x27;</span></span><br><span class="line">shform = sh[formStart: formEnd] </span><br><span class="line">shform</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/03.png" alt="03"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 画出2014年中国银行与浦发银行价格走势图</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)    </span><br><span class="line">PXf = shform[<span class="string">&#x27;601988&#x27;</span>]  <span class="comment"># 中国银行</span></span><br><span class="line">PYf = shform[<span class="string">&#x27;600000&#x27;</span>]  <span class="comment"># 浦发银行</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>]=<span class="literal">False</span></span><br><span class="line">plt.plot(PXf,<span class="string">&#x27;g&#x27;</span>,label=<span class="string">&#x27;601988（中国银行）&#x27;</span>)</span><br><span class="line">plt.plot(PYf,<span class="string">&#x27;b--&#x27;</span>,label=<span class="string">&#x27;600000（浦发银行）&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;2014年中国银行与浦发银行价格走势图&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;日期&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;股价&#x27;</span>)</span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/04.png" alt="04"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算形成期标准化价格价差及其均值和标准差</span></span><br><span class="line">returnX = (PXf-PXf.shift(<span class="number">1</span>))/PXf.shift(<span class="number">1</span>)[<span class="number">1</span>:]  <span class="comment"># 中国银行收益率</span></span><br><span class="line">returnY = (PYf-PYf.shift(<span class="number">1</span>))/PYf.shift(<span class="number">1</span>)[<span class="number">1</span>:]  <span class="comment"># 浦发银行收益率</span></span><br><span class="line">standardX = (returnX+<span class="number">1</span>).cumprod()  <span class="comment"># 中国银行标准化价格</span></span><br><span class="line">standardY = (returnY+<span class="number">1</span>).cumprod()  <span class="comment"># 浦发银行标准化价格</span></span><br><span class="line">SSD_pair = standardY-standardX  <span class="comment"># 求浦发银行与中国银行标准化价格序列的价差 </span></span><br><span class="line">meanSSD_pair = np.mean(SSD_pair)</span><br><span class="line">sdSSD_pair = np.std(SSD_pair)</span><br><span class="line">thresholdUpOpen = meanSSD_pair+<span class="number">1.5</span>*sdSSD_pair</span><br><span class="line">thresholdDownOpen = meanSSD_pair-<span class="number">1.5</span>*sdSSD_pair</span><br><span class="line">thresholdUpClose = meanSSD_pair+<span class="number">0.2</span>*sdSSD_pair</span><br><span class="line">thresholdDownClose = meanSSD_pair-<span class="number">0.2</span>*sdSSD_pair</span><br><span class="line">thresholdUpStopLoss = meanSSD_pair+<span class="number">2.5</span>*sdSSD_pair</span><br><span class="line">thresholdDownStopLoss = meanSSD_pair-<span class="number">2.5</span>*sdSSD_pair</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;meanSSD_pair= %s,\n sdSSD_pair= %s&#x27;</span>% (meanSSD_pair, sdSSD_pair))</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/05.png" alt="05"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 画出2014年中国银行与浦发银行价格走势图</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)    </span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>]=<span class="literal">False</span></span><br><span class="line">plt.plot(standardX, <span class="string">&#x27;g&#x27;</span>, label=<span class="string">&#x27;601988（中国银行标准化价格）&#x27;</span>)</span><br><span class="line">plt.plot(standardY, <span class="string">&#x27;b--&#x27;</span>, label=<span class="string">&#x27;600000（浦发银行标准化价格）&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;2014年中国银行与浦发银行标准化价格价格走势图&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;日期&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;标准化价格&#x27;</span>)</span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/06.png" alt="06"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 画出形成期中国银行与浦发银行标准化价差序列</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>) </span><br><span class="line">SSD_pair.plot(label=<span class="string">&#x27;标准化价差&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;中国银行与浦发银行标准化价差序列(形成期)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.axhline(y=meanSSD_pair,color=<span class="string">&#x27;black&#x27;</span>,label=<span class="string">&#x27;均值&#x27;</span>) <span class="comment"># matplotlib.pyplot.axhline(y=0, xmin=0, xmax=1, **kwargs) Add a horizontal line across the axis.</span></span><br><span class="line">plt.axhline(y=thresholdUpOpen, color=<span class="string">&#x27;green&#x27;</span>, label=<span class="string">&#x27;开仓线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownOpen, color=<span class="string">&#x27;green&#x27;</span>) </span><br><span class="line">plt.axhline(y=thresholdUpClose, color=<span class="string">&#x27;red&#x27;</span>, label=<span class="string">&#x27;平仓线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownClose, color=<span class="string">&#x27;red&#x27;</span>) </span><br><span class="line">plt.axhline(y=thresholdUpStopLoss, color=<span class="string">&#x27;blue&#x27;</span>, label=<span class="string">&#x27;止损线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownStopLoss, color=<span class="string">&#x27;blue&#x27;</span>) </span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/07.png" alt="07"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算股票对标准化价格偏差之平方和函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SSD</span>(<span class="params">priceX, priceY</span>):</span><br><span class="line">    <span class="keyword">if</span> priceX <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> priceY <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;缺少价格序列.&#x27;</span>)</span><br><span class="line">    returnX=(priceX-priceX.shift(<span class="number">1</span>))/priceX.shift(<span class="number">1</span>)[<span class="number">1</span>:]</span><br><span class="line">    returnY=(priceY-priceY.shift(<span class="number">1</span>))/priceY.shift(<span class="number">1</span>)[<span class="number">1</span>:]</span><br><span class="line">    standardX=(returnX+<span class="number">1</span>).cumprod()</span><br><span class="line">    standardY=(returnY+<span class="number">1</span>).cumprod()</span><br><span class="line">    SSD=np.<span class="built_in">sum</span>((standardX-standardY)**<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span>(SSD) </span><br><span class="line">    </span><br><span class="line">dis = SSD(PXf, PYf)</span><br><span class="line">dis</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/08.png" alt="08"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算交易期标准化价格价差及其统计量</span></span><br><span class="line">tradStart = <span class="string">&#x27;2015-01-01&#x27;</span></span><br><span class="line">tradEnd = <span class="string">&#x27;2015-06-30&#x27;</span></span><br><span class="line">PXt = sh.loc[tradStart:tradEnd,<span class="string">&#x27;601988&#x27;</span>]</span><br><span class="line">PYt = sh.loc[tradStart:tradEnd,<span class="string">&#x27;600000&#x27;</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">spreadCal</span>(<span class="params">x,y</span>):</span><br><span class="line">    retx=(x-x.shift(<span class="number">1</span>))/x.shift(<span class="number">1</span>)[<span class="number">1</span>:]</span><br><span class="line">    rety=(y-y.shift(<span class="number">1</span>))/y.shift(<span class="number">1</span>)[<span class="number">1</span>:]</span><br><span class="line">    standardX=(<span class="number">1</span>+retx).cumprod()</span><br><span class="line">    standardY=(<span class="number">1</span>+rety).cumprod()</span><br><span class="line">    spread=standardX-standardY</span><br><span class="line">    <span class="keyword">return</span>(spread)</span><br><span class="line">TradSpread = spreadCal(PYt,PXt)<span class="comment">#.dropna()</span></span><br><span class="line"><span class="built_in">print</span>(TradSpread.head(<span class="number">3</span>))</span><br><span class="line">TradSpread.describe() </span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/09.png" alt="09"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 画出2015年上半年中国银行与浦发银行标准化价格走势图</span></span><br><span class="line">returnXt = (PXt-PXt.shift(<span class="number">1</span>))/PXt.shift(<span class="number">1</span>)[<span class="number">1</span>:]<span class="comment">#中国银行收益率</span></span><br><span class="line">returnYt = (PYt-PYt.shift(<span class="number">1</span>))/PYt.shift(<span class="number">1</span>)[<span class="number">1</span>:]<span class="comment">#浦发银行收益率</span></span><br><span class="line">standardXt = (returnXt+<span class="number">1</span>).cumprod() <span class="comment"># 中国银行标准化价格</span></span><br><span class="line">standardYt = (returnYt+<span class="number">1</span>).cumprod() <span class="comment"># 浦发银行标准化价格</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)    </span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">plt.plot(standardXt, <span class="string">&#x27;g&#x27;</span>, label=<span class="string">&#x27;601988（中国银行标准化价格）&#x27;</span>)</span><br><span class="line">plt.plot(standardYt, <span class="string">&#x27;b--&#x27;</span>, label=<span class="string">&#x27;600000（浦发银行标准化价格）&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;2015年上半年中国银行与浦发银行标准化价格价格走势图&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;日期&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;标准化价格&#x27;</span>)</span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/10.png" alt="10"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 画出交易期中国银行与浦发银行标准化价差序列</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)    </span><br><span class="line">TradSpread.plot(label=<span class="string">&#x27;交易期价差序列&#x27;</span>, lw=<span class="number">3</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;交易期价差序列&#x27;</span>)</span><br><span class="line">plt.axhline(y=meanSSD_pair, color=<span class="string">&#x27;black&#x27;</span>, label=<span class="string">&#x27;均值&#x27;</span>)  </span><br><span class="line">plt.axhline(y=thresholdUpOpen, color=<span class="string">&#x27;green&#x27;</span>, label=<span class="string">&#x27;开仓线&#x27;</span>, ls=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownOpen, color=<span class="string">&#x27;green&#x27;</span>, ls=<span class="string">&#x27;--&#x27;</span>) </span><br><span class="line">plt.axhline(y=thresholdUpClose, color=<span class="string">&#x27;red&#x27;</span>, label=<span class="string">&#x27;平仓线&#x27;</span>, ls=<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownClose, color=<span class="string">&#x27;red&#x27;</span>, ls=<span class="string">&#x27;:&#x27;</span>) </span><br><span class="line">plt.axhline(y=thresholdUpStopLoss, color=<span class="string">&#x27;blue&#x27;</span>, label=<span class="string">&#x27;止损线&#x27;</span>, ls=<span class="string">&#x27;-.&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownStopLoss, color=<span class="string">&#x27;blue&#x27;</span>, ls=<span class="string">&#x27;-.&#x27;</span>) </span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/11.png" alt="11"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最小距离法配对策略的执行</span></span><br><span class="line"><span class="comment"># 设置价差所处区间</span></span><br><span class="line">level=(<span class="built_in">float</span>(<span class="string">&#x27;-inf&#x27;</span>),thresholdDownStopLoss,thresholdDownOpen,thresholdDownClose,\</span><br><span class="line">       thresholdUpClose,thresholdUpOpen,thresholdUpStopLoss,<span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">round</span>(level,<span class="number">3</span>))</span><br><span class="line">prcLevel = pd.cut(TradSpread,level,labels=<span class="literal">False</span>)-<span class="number">3</span>  <span class="comment"># 返回价差所处区间，记均值附近0.2个标准差区间为0区，</span></span><br><span class="line">                                                  <span class="comment"># 向上依次1，2，3区，向下依次为-1,-2,-3区</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">prcLevel.plot.bar(label=<span class="string">&#x27;价差所处区间&#x27;</span>)  <span class="comment">#plt.bar(prcLevel.index,prcLevel,label=&#x27;价差所处区间&#x27;) </span></span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/12.png" alt="12"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义交易信号函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">TradeSig</span>(<span class="params">prcLevel</span>):</span><br><span class="line">    n=<span class="built_in">len</span>(prcLevel)</span><br><span class="line">    signal=np.zeros(n,dtype=np.int16)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">        <span class="keyword">if</span> prcLevel[i-<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> prcLevel[i]==<span class="number">2</span>: <span class="comment"># 从1区到2区，向上突破开仓线，如之前未开仓则开仓</span></span><br><span class="line">            signal[i]=-<span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> prcLevel[i-<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> prcLevel[i]==<span class="number">0</span>:<span class="comment"># 从1区到0区，向下突破平仓线，如之前开仓则平仓</span></span><br><span class="line">            signal[i]=<span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> prcLevel[i-<span class="number">1</span>]==<span class="number">2</span> <span class="keyword">and</span> prcLevel[i]==<span class="number">3</span>: <span class="comment"># 从2区到3区，向上突破止损线，如之前开仓则平仓止损</span></span><br><span class="line">            signal[i]=<span class="number">3</span></span><br><span class="line">        <span class="keyword">elif</span> prcLevel[i-<span class="number">1</span>]==-<span class="number">1</span> <span class="keyword">and</span> prcLevel[i]==-<span class="number">2</span>:<span class="comment"># 从-1区到-2区，向下突破开仓线，如之前未开仓则开仓</span></span><br><span class="line">            signal[i]=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> prcLevel[i-<span class="number">1</span>]==-<span class="number">1</span> <span class="keyword">and</span> prcLevel[i]==<span class="number">0</span>:<span class="comment"># 从-1区到0区，向上突破平仓线，如之前开仓则平仓</span></span><br><span class="line">            signal[i]=-<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> prcLevel[i-<span class="number">1</span>]==-<span class="number">2</span> <span class="keyword">and</span> prcLevel[i]==-<span class="number">3</span>:<span class="comment"># 从-2区到-3区，向下突破止损线，如之前开仓则平仓止损</span></span><br><span class="line">            signal[i]=-<span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span>(signal)</span><br><span class="line"></span><br><span class="line">signal=TradeSig(prcLevel)</span><br><span class="line"><span class="comment"># plt.plot(prcLevel.index,signal,label=&#x27;交易信号&#x27;)</span></span><br><span class="line"><span class="comment"># plt.legend()</span></span><br><span class="line">ua, uind = np.unique(signal,return_inverse=<span class="literal">True</span>) </span><br><span class="line">count = np.bincount(uind) </span><br><span class="line"><span class="built_in">print</span>(ua,<span class="string">&#x27;\n&#x27;</span>,count)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/13.png" alt="13"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">position = [signal[<span class="number">0</span>]]</span><br><span class="line">ns = <span class="built_in">len</span>(signal)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,ns):</span><br><span class="line">    position.append(position[-<span class="number">1</span>]) <span class="comment"># 如果下面的判断语句都为否，则仓位与上一时间相同</span></span><br><span class="line">    <span class="keyword">if</span> signal[i]==<span class="number">1</span>: <span class="comment"># 从-1区到-2区，向下突破开仓线，如之前已开仓则不操作保持开仓；如之前未开仓则开仓 （买入浦东银行、卖出中国银行）</span></span><br><span class="line">        position[i]=<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> signal[i]==-<span class="number">2</span>:  <span class="comment"># 从1区到2区，向上突破开仓线，，如之前已开仓则不操作保持开仓；如之前未开仓则开仓（卖出浦东银行、买入中国银行）</span></span><br><span class="line">        position[i]=-<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> signal[i]==-<span class="number">1</span>: <span class="comment"># and position[i-1]==1: # 从-1区到0区，向上突破平仓线，如之前开仓（从-1区到-2区开仓position[i-1]==1）则平仓</span></span><br><span class="line">        position[i]=<span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> signal[i]==<span class="number">2</span>: <span class="comment"># and position[i-1]==-1: # 从1区到0区，向下突破平仓线，如之前开仓（从1区到2区开仓position[i-1]==-1）则平仓</span></span><br><span class="line">        position[i]=<span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> signal[i]==<span class="number">3</span>: <span class="comment"># 从2区到3区，向上突破止损线，平仓止损</span></span><br><span class="line">        position[i]=<span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> signal[i]==-<span class="number">3</span>: <span class="comment"># 从-2区到-3区，向下突破止损线，平仓止损</span></span><br><span class="line">        position[i]=<span class="number">0</span></span><br><span class="line">position = pd.Series(position, index=prcLevel.index)</span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">plt.plot(position.index, position, label=<span class="string">&#x27;交易仓位（买入浦东银行、卖出中国银行）&#x27;</span>)</span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/14.png" alt="14"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义交易账户函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">TradeSimSSD</span>(<span class="params">priceX,priceY,position</span>):</span><br><span class="line">    n=<span class="built_in">len</span>(position)</span><br><span class="line">    size=<span class="number">1000</span></span><br><span class="line">    shareY=size*position </span><br><span class="line">    shareX=[-shareY[<span class="number">0</span>]*priceY[<span class="number">0</span>]/priceX[<span class="number">0</span>]] <span class="comment"># 双边建仓资金相同</span></span><br><span class="line">    cash=[<span class="number">20000</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">        shareX.append(shareX[i-<span class="number">1</span>]) <span class="comment"># 如果下面的判断语句都为否，则仓位与上一时间相同</span></span><br><span class="line">        cash.append(cash[i-<span class="number">1</span>])     <span class="comment"># 如果没有新的开仓平仓操作，则现金与上一时间相同</span></span><br><span class="line">        <span class="keyword">if</span> position[i-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> position[i]==<span class="number">1</span>: <span class="comment">#新开仓</span></span><br><span class="line">            shareX[i]=-shareY[i]*priceY[i]/priceX[i]</span><br><span class="line">            <span class="comment">#cash[i]=cash[i-1]-(shareY[i]*priceY[i]+shareX[i]*priceX[i])</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：买入 %0.2f 元浦发银行股票，同时卖空 %0.2f元中国银行股票 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),shareY[i]*priceY[i],-shareX[i]*priceX[i]))</span><br><span class="line">        <span class="keyword">elif</span> position[i-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> position[i]==-<span class="number">1</span>:</span><br><span class="line">            shareX[i]=-shareY[i]*priceY[i]/priceX[i]</span><br><span class="line">            <span class="comment">#cash[i]=cash[i-1]-(shareY[i]*priceY[i]+shareX[i]*priceX[i])</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：卖空 %0.2f 元浦发银行股票，同时买入 %0.2f元中国银行股票 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),-shareY[i]*priceY[i],shareX[i]*priceX[i]))</span><br><span class="line">        <span class="keyword">elif</span> position[i-<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> position[i]==<span class="number">0</span>:</span><br><span class="line">            shareX[i]=<span class="number">0</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+(shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：卖出 %0.2f 元浦发银行股票，同时买入 %0.2f中国银行股票（平仓中国银行空头）: 获利 %0.2f 元 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),shareY[i-<span class="number">1</span>]*priceY[i],-shareX[i-<span class="number">1</span>]*priceX[i],shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i] ))</span><br><span class="line">        <span class="keyword">elif</span> position[i-<span class="number">1</span>]==-<span class="number">1</span> <span class="keyword">and</span> position[i]==<span class="number">0</span>:</span><br><span class="line">            shareX[i]=<span class="number">0</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+(shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：买入 %0.2f 元浦发银行股票（平仓浦发银行空头），同时卖出 %0.2f中国银行股票: 获利 %0.2f 元 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),-shareY[i-<span class="number">1</span>]*priceY[i],shareX[i-<span class="number">1</span>]*priceX[i],shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i] ))</span><br><span class="line">        <span class="keyword">elif</span> position[i-<span class="number">1</span>]==-<span class="number">1</span> <span class="keyword">and</span> position[i]==<span class="number">1</span>:</span><br><span class="line">            <span class="comment"># 先平仓 position: -1--&gt;0</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+(shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：买入 %0.2f 元浦发银行股票（平仓浦发银行空头），同时卖出 %0.2f中国银行股票: 获利 %0.2f 元 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),-shareY[i-<span class="number">1</span>]*priceY[i],shareX[i-<span class="number">1</span>]*priceX[i],shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i] ))</span><br><span class="line">            <span class="comment"># 再反向开仓 position: 0--&gt;1</span></span><br><span class="line">            shareX[i]=-shareY[i]*priceY[i]/priceX[i]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：买入 %0.2f 元浦发银行股票，同时卖空 %0.2f元中国银行股票 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),shareY[i]*priceY[i],-shareX[i]*priceX[i]))</span><br><span class="line">        <span class="keyword">elif</span> position[i-<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> position[i]==-<span class="number">1</span>:</span><br><span class="line">            <span class="comment"># 先平仓 position: 1--&gt;0</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+(shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：卖出 %0.2f 元浦发银行股票，同时买入 %0.2f 中国银行股票（平仓中国银行空头）: 获利 %0.2f 元 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),shareY[i-<span class="number">1</span>]*priceY[i],-shareX[i-<span class="number">1</span>]*priceX[i],shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i] ))</span><br><span class="line">            <span class="comment"># 再反向开仓 position: 0--&gt;-1</span></span><br><span class="line">            shareX[i]=-shareY[i]*priceY[i]/priceX[i]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓卖空 %0.2f 元浦发银行股票，同时买入 %0.2f元中国银行股票 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),-shareY[i]*priceY[i],shareX[i]*priceX[i]))</span><br><span class="line">            </span><br><span class="line">    cash = pd.Series(cash,index=position.index)</span><br><span class="line">    shareY=pd.Series(shareY,index=position.index)</span><br><span class="line">    shareX=pd.Series(shareX,index=position.index)</span><br><span class="line">    stockvalue=shareY*priceY+shareX*priceX</span><br><span class="line">    asset=cash+stockvalue</span><br><span class="line">    account=pd.DataFrame(&#123;<span class="string">&#x27;Position&#x27;</span>:position, <span class="string">&#x27;ShareY&#x27;</span>:shareY, <span class="string">&#x27;PriceY&#x27;</span>:priceY, <span class="string">&#x27;ShareX&#x27;</span>:shareX, <span class="string">&#x27;PriceX&#x27;</span>:priceX, <span class="string">&#x27;StockValue&#x27;</span>:stockvalue, <span class="string">&#x27;Cash&#x27;</span>:cash, <span class="string">&#x27;Asset&#x27;</span>:asset,&#125;)</span><br><span class="line">    <span class="keyword">return</span>(account)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 交易记录</span></span><br><span class="line">account=TradeSimSSD(PXt, PYt, position)<span class="comment">#.dropna()</span></span><br><span class="line">account.to_csv(<span class="string">&#x27;SSD.csv&#x27;</span>)</span><br><span class="line"><span class="built_in">format</span> = <span class="keyword">lambda</span> x:<span class="string">&#x27;%.2f&#x27;</span> % x</span><br><span class="line"><span class="built_in">print</span>(account.applymap(<span class="built_in">format</span>).iloc[[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,-<span class="number">2</span>,-<span class="number">1</span>]]) <span class="comment"># 保留两位小数输出</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/15.png" alt="15"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 画出交易账户仓位和资产序列</span></span><br><span class="line">account.loc[:,(<span class="string">&#x27;ShareY&#x27;</span>,<span class="string">&#x27;Cash&#x27;</span>,<span class="string">&#x27;Asset&#x27;</span>)].plot(style=[<span class="string">&#x27;--&#x27;</span>,<span class="string">&#x27;:&#x27;</span>],color=[<span class="string">&#x27;black&#x27;</span>,<span class="string">&#x27;blue&#x27;</span>,<span class="string">&#x27;red&#x27;</span>])</span><br><span class="line">plt.title(<span class="string">&#x27;配对交易账户&#x27;</span>) </span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/16.png" alt="16"></p>
<h1 id="配对交易的潜在收益与风险"><a class="markdownIt-Anchor" href="#配对交易的潜在收益与风险"></a> 配对交易的潜在收益与风险</h1>
<ul>
<li>
<p>配对交易收益的来源</p>
<ul>
<li>传统资产定价：潜在风险因子的补偿，例如某一方的破产风险</li>
<li>行为金融：投资者非理性交易，例如追涨杀跌</li>
</ul>
</li>
<li>
<p>配对交易的收益与风险</p>
<ul>
<li>收益：更多的交易机会-具有较小价差对中选择价差序列方差最大的股票对</li>
<li>风险：价差序列不稳定，分离后不回归</li>
<li>检验价差序列的平稳性：协整的概念</li>
</ul>
</li>
</ul>
<h1 id="协整"><a class="markdownIt-Anchor" href="#协整"></a> 协整</h1>
<ul>
<li>
<p>协整 (Co-Integration): 两只股票价格序列本身都没有平稳性，但他们价格序列的线性组合具有平稳性</p>
</li>
<li>
<p>时间序列： 一组随机变量按时间排序的序列叫做时间序列，可以记作<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>X</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>X</mi><mi>t</mi></msub><mo separator="true">,</mo><mo>⋯</mo></mrow><annotation encoding="application/x-tex">X_1,X_2,\cdots,X_t,\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span></span></span></span>. 对于随时间观测到的时间序列的一组样本<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mo>⋯</mo></mrow><annotation encoding="application/x-tex">x_1,x_2,\cdots,x_t,\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span></span></span></span>，例如历史股票价格序列，称之为时间序列的实现值。</p>
<ul>
<li>参考书：《<a target="_blank" rel="noopener" href="https://book.douban.com/subject/11610921/">金融时间序列分析</a>》第三版，<a target="_blank" rel="noopener" href="https://faculty.chicagobooth.edu/ruey-s-tsay/research/analysis-of-financial-time-series-3rd-edition">Ruey S. Tsay</a>著</li>
<li>《<a target="_blank" rel="noopener" href="https://book.douban.com/subject/10743316/">金融计量学：从初级到高级建模技术</a>》，维特夫Rachev等著.</li>
</ul>
</li>
<li>
<p>弱平稳（或者协方差平稳）：称时间序列<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">X_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为弱平稳或者协方差平稳，如果它的均值、方差和协方差都不依赖于时间<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span>，即：</p>
</li>
</ul>
\begin{align*}
E(X_t)&=\mu\\
Var(X_t)&=\sigma^2\\
Cov(X_t, X_{t-l})&=\gamma_l, \forall t,l
\end{align*}

<h1 id="自相关系数"><a class="markdownIt-Anchor" href="#自相关系数"></a> 自相关系数</h1>
<p>对于弱平稳时间序列，可以定义</p>
<ul>
<li>
<p>自协方差 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>γ</mi><mi>l</mi></msub><mo>=</mo><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>l</mi></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>l</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo></mrow><annotation encoding="application/x-tex">\gamma_l=Cov(X_t, X_{t-l}), l=0,1,2,\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span></span></span></span></p>
</li>
<li>
<p>自相关函数 （Autocorrelation Function, ACF）<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mi>l</mi></msub><mo>=</mo><mfrac><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>l</mi></mrow></msub><mo stretchy="false">)</mo></mrow><msqrt><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>l</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msqrt></mfrac><mo>=</mo><mfrac><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>l</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mfrac><msub><mi>γ</mi><mi>l</mi></msub><msub><mi>γ</mi><mn>0</mn></msub></mfrac><mo separator="true">,</mo><mi>l</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo></mrow><annotation encoding="application/x-tex">\rho_l=\frac{Cov(X_t, X_{t-l})}{\sqrt{Var(X_t)Var(X_{t-l})}}=\frac{Cov(X_t, X_{t-l})}{Var(X_t)}=\frac{\gamma_l}{\gamma_0}, l=0,1,2,\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.8396em;vertical-align:-0.8295999999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.4641625em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0369107142857144em;"><span class="svg-align" style="top:-3.428571428571429em;"><span class="pstrut" style="height:3.428571428571429em;"></span><span class="mord mtight" style="padding-left:1.19em;"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.3487714285714287em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.21074999999999994em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span><span style="top:-3.0089107142857143em;"><span class="pstrut" style="height:3.428571428571429em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.5428571428571431em;"><svg width="400em" height="1.5428571428571431em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4196607142857143em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.3487714285714287em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.21074999999999994em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8295999999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.3487714285714287em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.21074999999999994em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.228608em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.05556em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.05556em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span></span></span></span></p>
<ul>
<li><code>statsmodels.tsa.stattools.acf()</code> 计算时间序列的自相关系数</li>
<li><a target="_blank" rel="noopener" href="https://pypi.org/project/statsmodels/">Statistical computations and models for Python</a>: <a target="_blank" rel="noopener" href="https://www.statsmodels.org/stable/user-guide.html">statsmodels user guide</a></li>
</ul>
</li>
<li>
<p>协方差和相关系数是数据之间线性独立性的衡量：如果 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>是均值为0的正态随机变量，考虑 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>X</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">X^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>的相关性</p>
</li>
</ul>
<h1 id="自相关系数的统计检验"><a class="markdownIt-Anchor" href="#自相关系数的统计检验"></a> 自相关系数的统计检验</h1>
<ul>
<li>
<p>样本<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>r</mi><mi>t</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">\{r_t\}_{t=1}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span></span>的间隔为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span>的自相关系数定义为<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>ρ</mi><mo>^</mo></mover><mi>l</mi></msub><mo>=</mo><mfrac><mrow><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mi>l</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mo stretchy="false">(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>−</mo><mover accent="true"><mi>r</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mi>l</mi></mrow></msub><mo>−</mo><mover accent="true"><mi>r</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo></mrow><mrow><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mo stretchy="false">(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>−</mo><mover accent="true"><mi>r</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo></mrow></mfrac><mo separator="true">,</mo><mi>l</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>T</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\hat{\rho}_l=\frac{\sum_{t=l+1}^T(r_t-\bar{r})(r_{t-l}-\bar{r})}{\sum_{t=1}^T(r_t-\bar{r})}, l=0,1,2,\cdots,T-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.8747090000000002em;vertical-align:-0.654672em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.220037em;"><span style="top:-2.570335em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8852357142857143em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971428571428572em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32143857142857146em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mtight">ˉ</span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5766720000000003em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9190928571428572em;"><span style="top:-2.1785614285714288em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.38096em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mtight">ˉ</span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.21074999999999994em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mtight">ˉ</span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.654672em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>
<ul>
<li>若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{r_t\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> iid 且方差有限,则 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>ρ</mi><mo>^</mo></mover><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">\hat{\rho}_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>渐进服从 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(0, 1/T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span></li>
<li>若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{r_t\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> 弱平稳满足 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mi>μ</mi><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>q</mi></msubsup><msub><mi>ψ</mi><mi>i</mi></msub><msub><mi>a</mi><mrow><mi>t</mi><mo>−</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">r_t=\mu+\sum_{i=0}^q \psi_i a_{t-i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029000000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>,其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>a</mi><mi>j</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{a_j\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>为高斯白噪声序列，则对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>&gt;</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">l&gt;q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>ρ</mi><mo>^</mo></mover><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">\hat{\rho}_l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">ρ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>渐进服从 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></msubsup><msubsup><mi>ρ</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(0, (1+2\sum_{i=1}^q \rho_i^2)/T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.113818em;vertical-align:-0.29971000000000003em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029000000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span>计算时间序列的自相关系数</li>
</ul>
</li>
<li>
<p>检验单个ACF: 在 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mi>l</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho_l=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>原假设下，统计量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><msub><mover accent="true"><mi>ρ</mi><mo>^</mo></mover><mi>l</mi></msub><msqrt><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>2</mn><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>q</mi></msubsup><msubsup><mover accent="true"><mi>ρ</mi><mo>^</mo></mover><mi>i</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>T</mi></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\frac{\hat{\rho}_l}{\sqrt{(1+2\sum_{i=1}^q \hat{\rho}_i^2)/T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.7618159999999998em;vertical-align:-0.8295999999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322159999999999em;"><span style="top:-2.4701725em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.028325em;"><span class="svg-align" style="top:-3.428571428571429em;"><span class="pstrut" style="height:3.428571428571429em;"></span><span class="mord mtight" style="padding-left:1.19em;"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mtight">2</span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7912285714285714em;"><span style="top:-2.177714285714286em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.9836857142857145em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3222857142857143em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mtight">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8051142857142857em;"><span style="top:-2.177714285714286em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-2.8448em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3222857142857143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.000325em;"><span class="pstrut" style="height:3.428571428571429em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.5428571428571431em;"><svg width="400em" height="1.5428571428571431em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4282464285714287em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mtight">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8295999999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>渐进服从标准正态分布<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p>
</li>
<li>
<p>混成检验（检验多个自相关系数是否同时为零）： 在 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mn>1</mn></msub><mo>=</mo><mo>⋯</mo><mo>=</mo><msub><mi>ρ</mi><mi>m</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho_1=\cdots=\rho_m=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>原假设下，Ljung and Box (1978) Q统计量 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><mi>T</mi><mo>+</mo><mn>2</mn><mo stretchy="false">)</mo><msubsup><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mfrac><msubsup><mover accent="true"><mi>ρ</mi><mo>^</mo></mover><mi>l</mi><mn>2</mn></msubsup><mrow><mi>T</mi><mo>−</mo><mi>l</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Q(m)=T(T+2)\sum_{l=1}^m \frac{\hat{\rho}_l^2}{T-l}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.537451em;vertical-align:-0.403331em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1341199999999998em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5102em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mtight">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.214em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>渐进服从自由度为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>的开方分布$ \chi_m^2$</p>
</li>
</ul>
<h1 id="stattoolsacf"><a class="markdownIt-Anchor" href="#stattoolsacf"></a> <code>stattools.acf?</code></h1>
<ul>
<li>Signature: stattools.acf(<br>
x,<br>
adjusted=False,<br>
nlags=None,<br>
qstat=False,<br>
fft=None,<br>
alpha=None,<br>
missing=‘none’,)</li>
<li>Docstring: Calculate the autocorrelation function.</li>
</ul>
<h2 id="parameters"><a class="markdownIt-Anchor" href="#parameters"></a> Parameters</h2>
<ul>
<li>x : array_like<br>
The time series data.</li>
<li>adjusted : bool, default False<br>
If True, then denominators for autocovariance are n-k, otherwise n.</li>
<li>nlags : int, default 40<br>
Number of lags to return autocorrelation for.</li>
<li>qstat : bool, default False<br>
If True, returns the Ljung-Box q statistic for each autocorrelation<br>
coefficient.  See q_stat for more information.</li>
<li>fft : bool, default None<br>
If True, computes the ACF via FFT.</li>
<li>alpha : scalar, default None<br>
If a number is given, the confidence intervals for the given level are<br>
returned. For instance if alpha=.05, 95 % confidence intervals are<br>
returned where the standard deviation is computed according to<br>
Bartlett&quot;s formula.</li>
<li>missing : str, default “none”<br>
A string in [“none”, “raise”, “conservative”, “drop”] specifying how<br>
the NaNs are to be treated. “none” performs no checks. “raise” raises<br>
an exception if NaN values are found. “drop” removes the missing<br>
observations and then estimates the autocovariances treating the<br>
non-missing as contiguous. “conservative” computes the autocovariance<br>
using nan-ops so that nans are removed when computing the mean<br>
and cross-products that are used to estimate the autocovariance.<br>
When using “conservative”, n is set to the number of non-missing<br>
observations.</li>
</ul>
<h2 id="returns"><a class="markdownIt-Anchor" href="#returns"></a> Returns</h2>
<ul>
<li>acf : ndarray<br>
The autocorrelation function.</li>
<li>confint : ndarray, optional<br>
Confidence intervals for the ACF. Returned if alpha is not None.</li>
<li>qstat : ndarray, optional<br>
The Ljung-Box Q-Statistic.  Returned if q_stat is True.</li>
<li>pvalues : ndarray, optional<br>
The p-values associated with the Q-statistics.  Returned if q_stat is<br>
True.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> statsmodels.tsa <span class="keyword">import</span> stattools</span><br><span class="line"><span class="keyword">from</span> statsmodels.graphics.tsaplots <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">12</span>,<span class="number">6</span>))</span><br><span class="line">ax1 = plt.subplot(<span class="number">211</span>)</span><br><span class="line">ax1.plot(PXf)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;2014年中国银行价格走势图&#x27;</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line">fig = plot_acf(PXf, lags=<span class="number">30</span>, ax=ax3)  <span class="comment"># 蓝色区域为自相关系数为0原假设下95%的置信区间</span></span><br><span class="line">ax3.set_xlabel(<span class="string">&#x27;2014年中国银行价格的自相关系数图&#x27;</span>) <span class="comment"># 当柱条超出蓝色上下界时，表示自相关系数显著不为0</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/17.png" alt="17"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fig = plt.figure(figsize=(<span class="number">12</span>,<span class="number">6</span>))</span><br><span class="line">ax2 = plt.subplot(<span class="number">211</span>)</span><br><span class="line">ax2.plot(returnX)</span><br><span class="line">ax2.set_title(<span class="string">&#x27;2014年中国银行收益率走势图&#x27;</span>)</span><br><span class="line">ax4 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line">fig = plot_acf(returnX.dropna(), lags=<span class="number">30</span>, ax=ax4)</span><br><span class="line">ax4.set_xlabel(<span class="string">&#x27;2014年中国银行收益率的自相关系数图&#x27;</span>) <span class="comment"># 当自相关系数快速降到0附近时，时间序列较有可能为平稳序列</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># stattools.acf(returnX,nlags=30,alpha=0.05,qstat=True,missing=&#x27;drop&#x27;)</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/18.png" alt="18"></p>
<h1 id="平稳性序列"><a class="markdownIt-Anchor" href="#平稳性序列"></a> 平稳性序列</h1>
<ul>
<li>
<p>时间序列的平稳性是其基本的假设，只有基于平稳时间序列的预测才是有效的。</p>
<ul>
<li>例如随机游走(random walk)<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t=x_{t-1}+\epsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.791661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><msub><mi>ϵ</mi><mi>t</mi></msub><mover><mo><mo>∼</mo></mo><mrow><mi>i</mi><mi>i</mi><mi>d</mi></mrow></mover><mtext> </mtext><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><msubsup><mi>σ</mi><mi>ϵ</mi><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_0=0,\epsilon_t  \overset{iid}{\sim} \ N(0, \sigma_\epsilon^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.347418em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.152978em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">∼</span></span></span><span style="top:-3.5668699999999998em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace"> </span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">ϵ</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。<br>
可得<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi><msubsup><mi>σ</mi><mi>ϵ</mi><mn>2</mn></msubsup><mo separator="true">,</mo><msub><mi>ρ</mi><mi>l</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>l</mi></mrow></msub><mo stretchy="false">)</mo></mrow><msqrt><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mrow><mi>t</mi><mo>−</mo><mi>l</mi></mrow></msub><mo stretchy="false">)</mo></mrow></msqrt></mfrac><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mi>l</mi><mo stretchy="false">)</mo><msubsup><mi>σ</mi><mi>ϵ</mi><mn>2</mn></msubsup></mrow><msqrt><mrow><mi>t</mi><msubsup><mi>σ</mi><mi>ϵ</mi><mn>2</mn></msubsup><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mi>l</mi><mo stretchy="false">)</mo><msubsup><mi>σ</mi><mi>ϵ</mi><mn>2</mn></msubsup></mrow></msqrt></mfrac><mo>=</mo><msqrt><mrow><mn>1</mn><mo>−</mo><mfrac><mi>l</mi><mi>t</mi></mfrac></mrow></msqrt></mrow><annotation encoding="application/x-tex">E(x_t)=0, Var(x_t)=t \sigma_\epsilon^2, 
\rho_l(t)=\frac{Cov(X_t, X_{t-l})}{\sqrt{Var(X_t)Var(X_{t-l})}}=\frac{(t-l)\sigma_\epsilon^2}{\sqrt{t \sigma_\epsilon^2 (t-l)\sigma_\epsilon^2}}=\sqrt{1-\frac{l}{t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">ϵ</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.8396em;vertical-align:-0.8295999999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.4641625em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0369107142857144em;"><span class="svg-align" style="top:-3.428571428571429em;"><span class="pstrut" style="height:3.428571428571429em;"></span><span class="mord mtight" style="padding-left:1.19em;"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mord mathdefault mtight" style="margin-right:0.22222em;">V</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.3487714285714287em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.21074999999999994em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span><span style="top:-3.0089107142857143em;"><span class="pstrut" style="height:3.428571428571429em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.5428571428571431em;"><svg width="400em" height="1.5428571428571431em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4196607142857143em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.3487714285714287em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.21074999999999994em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8295999999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.96372em;vertical-align:-0.8296em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1341199999999998em;"><span style="top:-2.4767625em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0189107142857143em;"><span class="svg-align" style="top:-3.428571428571429em;"><span class="pstrut" style="height:3.428571428571429em;"></span><span class="mord mtight" style="padding-left:1.19em;"><span class="mord mathdefault mtight">t</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.214em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">ϵ</span></span></span><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.214em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">ϵ</span></span></span><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.9909107142857145em;"><span class="pstrut" style="height:3.428571428571429em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.5428571428571431em;"><svg width="400em" height="1.5428571428571431em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4376607142857143em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5102em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.214em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">ϵ</span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8296em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.5874459999999999em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2525540000000002em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.212554em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em;"><svg width="400em" height="1.8800000000000001em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"><path d="M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,
572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,
-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39
c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60
s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,
-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10z
M1001 80H400000v40H1013z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5874459999999999em;"><span></span></span></span></span></span></span></span></span><br>
方差随时间增加，不是平稳序列；<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span>较大、<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span>较小时，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mi>l</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\rho_l(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span>接近<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>,但并不能用于预测（例如对数价格）</li>
<li>对于非平稳序列，一般对其进行差分，直至得到平稳序列。</li>
</ul>
</li>
<li>
<p>如果一个序列是非平稳的，经过<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span>次差分可以将其转换为平稳序列，则称其为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I(d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mclose">)</span></span></span></span>, 其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span>指整合(Integrated), <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span>为整合阶数。例如随机游走不是平稳序列，但经过一阶差分<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><msub><mi>x</mi><mi>t</mi></msub><mo>−</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Delta x_t=x_t-x_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>为平稳序列，故称随机游走<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为非平稳的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>序列</p>
</li>
</ul>
<h1 id="平稳性检验-单位根检验"><a class="markdownIt-Anchor" href="#平稳性检验-单位根检验"></a> 平稳性检验 -  单位根检验</h1>
<ul>
<li>
<p>时间序列是否平稳可以借助滞后算子<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>多项式方程是否有单位根来判断</p>
<ul>
<li>滞后算子<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>： $L x_t=x_{t-1},L^2 x_t=x_{t-2},\cdots $</li>
<li>例：对于随机游走，其对应滞后算子<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>多项式方程为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>−</mo><mi>L</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">1-  L=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>，有一个根为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，序列非平稳</li>
<li>对于一般的时间序列，如果其滞后算子多项式方程的所有根的绝对值都大于1，则平稳；如果存在单位根，则非平稳</li>
</ul>
</li>
<li>
<p>单位根检验：ADF检验（Augmented Dickey-Fuller Test）</p>
<ul>
<li>时间序列模型<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mi>α</mi><mo>+</mo><mi>β</mi><mi>t</mi><mo>+</mo><mi>γ</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>δ</mi><mn>1</mn></msub><mi mathvariant="normal">Δ</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>δ</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">Δ</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\Delta x_t=\alpha+\beta t+\gamma x_{t-1}+\delta_1 \Delta x_{t-1}+\cdots+\delta_{p-1} \Delta x_{t-p+1}+\epsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.791661em;vertical-align:-0.208331em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>ADF检验原假设为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>γ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\gamma=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> (有单位根，非平稳),备择假设为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mi>γ</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_1:\gamma&lt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>(没有单位根，平稳)</li>
<li><code>arch.unitroot.ADF()</code> 或者<code>statsmodels.tsa.stattools.adfuller()</code>实现ADF检验</li>
<li><a target="_blank" rel="noopener" href="https://pypi.org/project/arch/">ARCH for Python</a>(<a target="_blank" rel="noopener" href="https://github.com/bashtage/arch">GitHub</a>): <a target="_blank" rel="noopener" href="https://nbviewer.org/github/bashtage/arch/tree/main/examples/">ARCH examples</a>;<a target="_blank" rel="noopener" href="https://bashtage.github.io/arch/">documentation</a></li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对中国银行的对数价格进行一阶单整检验 </span></span><br><span class="line"><span class="comment"># 命令行 pip install arch 可能需要先装 visual studio</span></span><br><span class="line"><span class="comment"># conda install -c conda-forge arch-py</span></span><br><span class="line"><span class="keyword">from</span> arch.unitroot <span class="keyword">import</span> ADF</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">PXflog=np.log(PXf)  <span class="comment"># 计算对数价格</span></span><br><span class="line">adfX=ADF(PXflog)  <span class="comment"># ADF平稳性检验</span></span><br><span class="line"><span class="built_in">print</span>(adfX.summary().as_text())  <span class="comment"># 对数价格非平稳</span></span><br><span class="line"></span><br><span class="line">retX=PXflog.diff()[<span class="number">1</span>:]  <span class="comment"># 计算对数价格差分--对数收益率</span></span><br><span class="line">adfretX=ADF(retX)</span><br><span class="line"><span class="built_in">print</span>(adfretX.summary().as_text())  <span class="comment"># 对数价格差分平稳</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/19.png" alt="19"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对浦发银行的对数价格进行一阶单整检验 </span></span><br><span class="line"><span class="keyword">from</span> arch.unitroot <span class="keyword">import</span> ADF</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">PYflog=np.log(PYf) <span class="comment"># 计算对数价格</span></span><br><span class="line">adfY=ADF(PYflog) <span class="comment"># ADF平稳性检验</span></span><br><span class="line"><span class="built_in">print</span>(adfY.summary().as_text())  <span class="comment"># 对数价格非平稳</span></span><br><span class="line"></span><br><span class="line">retY=PYflog.diff()[<span class="number">1</span>:]  <span class="comment"># 计算对数价格差分--对数收益率</span></span><br><span class="line">adfretY=ADF(retY)</span><br><span class="line"><span class="built_in">print</span>(adfretY.summary().as_text())  <span class="comment"># 对数价格差分平稳</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/20.png" alt="20"></p>
<h1 id="白噪声序列"><a class="markdownIt-Anchor" href="#白噪声序列"></a> 白噪声序列</h1>
<ul>
<li>
<p>对于平稳时间序列，有两种可能</p>
<ul>
<li>序列存在自相关性，可以通过历史信息预测未来</li>
<li>序列不存在自相关性，通过历史信息无法预测未来-有效市场</li>
</ul>
</li>
<li>
<p>白噪声： 称时间序列<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">X_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为白噪声序列，如果它的均值、方差和协方差满足以下公式</p>
</li>
</ul>
\begin{align*}
E(X_t)&=0\\
Var(X_t)&=\sigma^2\\
Cov(X_t, X_{t-l})&=\gamma_l=0, \forall l>0
\end{align*}

<ul>
<li>如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">X_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>还服从正态分布，则称这个序列为高斯白噪声序列（Gaussian white noise）</li>
</ul>
<h1 id="白噪声检验"><a class="markdownIt-Anchor" href="#白噪声检验"></a> 白噪声检验</h1>
<ul>
<li>
<p>由定义白噪声序列一定是弱平稳序列，不同时间协方差为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>,故各期变量之间没有相关性，但没有相关性不一定独立</p>
<ul>
<li>GARCH模型中收益率残差项<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是白噪声，但其平方<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>ϵ</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\epsilon_t^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>有自相关</li>
<li>高斯白噪声一定独立</li>
</ul>
</li>
<li>
<p>白噪声检验：LB(Ljung-Box)检验</p>
<ul>
<li>LB检验的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span></span></span></span>统计量： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mo stretchy="false">(</mo><mi>T</mi><mo>+</mo><mn>2</mn><mo stretchy="false">)</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mfrac><msubsup><mover accent="true"><mi>ρ</mi><mo>^</mo></mover><mi>k</mi><mn>2</mn></msubsup><mrow><mi>T</mi><mo>−</mo><mi>k</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Q(m)=T(T+2)\sum_{k=1}^m \frac{\hat{\rho}_k^2}{T-k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.537451em;vertical-align:-0.403331em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1341199999999998em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5102em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">ρ</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.16666em;"><span class="mtight">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.214em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>,它越接近0越说明没有自相关性(滞后<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>阶)</li>
<li>LB检验原假设为所检序列为纯随机序列（无自相关性，白噪声过程）</li>
<li><code>statsmodels.tsa.stattools.q_stat()</code> 实现LB检验</li>
</ul>
</li>
</ul>
<h1 id="stattoolsq_stat"><a class="markdownIt-Anchor" href="#stattoolsq_stat"></a> <code>stattools.q_stat?</code></h1>
<ul>
<li>Signature: stattools.q_stat(x, nobs, type=None)</li>
<li>Docstring: Compute Ljung-Box Q Statistic.</li>
</ul>
<h2 id="parameters-2"><a class="markdownIt-Anchor" href="#parameters-2"></a> Parameters</h2>
<ul>
<li>x : array_like<br>
Array of autocorrelation coefficients.  Can be obtained from acf.</li>
<li>nobs : int, optional<br>
Number of observations in the entire sample (ie., not just the length<br>
of the autocorrelation function results.</li>
</ul>
<h2 id="returns-2"><a class="markdownIt-Anchor" href="#returns-2"></a> Returns</h2>
<ul>
<li>q-stat : ndarray<br>
Ljung-Box Q-statistic for autocorrelation parameters.</li>
<li>p-value : ndarray<br>
P-value of the Q statistic.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检验中国银行和浦发银行的对数价格差是否为白噪声 </span></span><br><span class="line"><span class="keyword">from</span> statsmodels.tsa <span class="keyword">import</span> stattools</span><br><span class="line"></span><br><span class="line"><span class="comment">#生成纯随机序列</span></span><br><span class="line">whiteNoise = np.random.standard_normal(size=<span class="number">500</span>)</span><br><span class="line"><span class="comment">#绘制序列图</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">plt.plot(whiteNoise, c=<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;White Noise&#x27;</span>)</span><br><span class="line"></span><br><span class="line">LjungBox0 = stattools.q_stat(stattools.acf(whiteNoise, nlags=<span class="number">40</span>, fft=<span class="literal">False</span>)[<span class="number">1</span>:<span class="number">13</span>], <span class="built_in">len</span>(whiteNoise))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;检验纯随机序列为白噪声的P值为 %s &#x27;</span> %LjungBox0[<span class="number">1</span>][-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">LjungBoxX = stattools.q_stat(stattools.acf(retX, nlags=<span class="number">40</span>, fft=<span class="literal">False</span>)[<span class="number">1</span>:<span class="number">13</span>], <span class="built_in">len</span>(retY))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;检验中国银行对数价格差为白噪声的P值为 %s &#x27;</span> %LjungBoxX[<span class="number">1</span>][-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">LjungBoxY = stattools.q_stat(stattools.acf(retY, nlags=<span class="number">40</span>, fft=<span class="literal">False</span>)[<span class="number">1</span>:<span class="number">13</span>], <span class="built_in">len</span>(retY))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;检验浦发银行对数价格差为白噪声的P值为 %s &#x27;</span> %LjungBoxY[<span class="number">1</span>][-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/21.png" alt="21"></p>
<h1 id="配对交易的协整模型一-协整关系检验"><a class="markdownIt-Anchor" href="#配对交易的协整模型一-协整关系检验"></a> 配对交易的协整模型：一、协整关系检验</h1>
<ul>
<li>协整 (Co-Integration): 两个时间序列本身都没有平稳性，但他们线性组合具有平稳性</li>
<li>金融资产的对数价格一般满足一阶单整序列。</li>
<li>假设 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>P</mi><mi>t</mi><mi>X</mi></msubsup><mo separator="true">,</mo><msubsup><mi>P</mi><mi>t</mi><mi>Y</mi></msubsup><mo separator="true">,</mo><mi>t</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">P_t^X, P_t^Y, t=0,1,2, \ldots, T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.088331em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span></span> 分别为股票<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>和股票<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>在时间<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span>（形成期）的价格，通过 <a target="_blank" rel="noopener" href="https://www.jstor.org/stable/1913236">Engle and Granger (1987)</a>两步法可以对对数股票价格<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msubsup><mi>P</mi><mi>t</mi><mi>X</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log (P_t^X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msubsup><mi>P</mi><mi>t</mi><mi>Y</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(P_t^Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>进行协整关系检验
<ul>
<li>(1). 在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msubsup><mi>P</mi><mi>t</mi><mi>X</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log (P_t^X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msubsup><mi>P</mi><mi>t</mi><mi>Y</mi></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log(P_t^Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>都是一阶单整的前提下，构造回归方程</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msubsup><mi>P</mi><mi>t</mi><mi>Y</mi></msubsup><mo stretchy="false">)</mo><mo>=</mo><mi>α</mi><mo>+</mo><mi>β</mi><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msubsup><mi>P</mi><mi>t</mi><mi>X</mi></msubsup><mo stretchy="false">)</mo><mo>+</mo><msub><mi>ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\log(P_t^Y)=\alpha+\beta \log (P_t^X)+\epsilon_t
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.22222em;">Y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
用最小二乘法得到回归系数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>α</mi><mo>^</mo></mover><mo separator="true">,</mo><mover accent="true"><mi>β</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\alpha},\hat{\beta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523199999999998em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;">^</span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>和残差项<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>ϵ</mi><mo>^</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\hat{\epsilon}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
<ul>
<li>(2). 对残差项<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>ϵ</mi><mo>^</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\hat{\epsilon}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">ϵ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>进行平稳性检验(ADF检验是否存在单位根)</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> statsmodels.api <span class="keyword">as</span> sm</span><br><span class="line"></span><br><span class="line"><span class="comment">#在形成期，将浦发银行股票对数价格对中国银行股票对数价格回归分析 </span></span><br><span class="line">model = sm.OLS(PYflog, sm.add_constant(PXflog))</span><br><span class="line">results = model.fit()</span><br><span class="line"><span class="built_in">print</span>(results.summary())</span><br><span class="line"></span><br><span class="line">alpha = results.params[<span class="number">0</span>]  <span class="comment"># 常数估计\hat&#123;alpha&#125;</span></span><br><span class="line">beta = results.params[<span class="number">1</span>]   <span class="comment"># 自变量系数估计 \hat&#123;beta&#125;</span></span><br><span class="line">spreadf = PYflog-beta*PXflog-alpha  <span class="comment"># 残差</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/22.png" alt="22"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#对残差项进行平稳性检验进行平稳性检验(ADF检验是否存在单位根)</span></span><br><span class="line">spreadf.plot()</span><br><span class="line">plt.title(<span class="string">&#x27;价差序列&#x27;</span>) </span><br><span class="line"></span><br><span class="line">adfSpread=ADF(spreadf, trend=<span class="string">&#x27;c&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(adfSpread.summary().as_text())</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/23.png" alt="23"></p>
<h1 id="配对交易的协整模型二-设定交易规则"><a class="markdownIt-Anchor" href="#配对交易的协整模型二-设定交易规则"></a> 配对交易的协整模型：二、设定交易规则</h1>
<ul>
<li>计算形成期内价差序列（回归残差项）的均值和标准差</li>
</ul>
  \begin{align}
 \mu=\frac{1}{T}\sum_{t=1}^T \hat{\epsilon}_t,  \sigma=\sqrt{\frac{1}{T-1}\sum_{t=1}^T (\hat{\epsilon}_t-\mu)^2}
 \end{align}

<ul>
<li>开仓：在交易期，当标准化股票价差超过<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>+</mo><mn>1.5</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu+1.5\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>或者低于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>−</mo><mn>1.5</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu-1.5\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>开仓</li>
<li>平仓：在交易期，开仓后当标准化股票价差恢复到均值附近平仓（价差超过<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>+</mo><mn>1.5</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu+1.5\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>的开仓，当价差恢复到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>+</mo><mn>0.2</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu+0.2\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>平仓；价差超过<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>−</mo><mn>1.5</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu-1.5\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>的开仓，当价差恢复到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>−</mo><mn>0.2</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu-0.2\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>平仓）</li>
<li>止损：在交易期，开仓后当标准化股票价差突破<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>±</mo><mn>2.5</mn><mi>σ</mi></mrow><annotation encoding="application/x-tex">\mu\pm 2.5\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>，平仓止损</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mean_co = np.mean(spreadf)</span><br><span class="line">sd_co = np.std(spreadf)</span><br><span class="line">thresholdUpOpen_co = mean_co+<span class="number">1.5</span>*sd_co</span><br><span class="line">thresholdDownOpen_co = mean_co-<span class="number">1.5</span>*sd_co</span><br><span class="line">thresholdUpClose_co = mean_co+<span class="number">0.2</span>*sd_co</span><br><span class="line">thresholdDownClose_co = mean_co-<span class="number">0.2</span>*sd_co</span><br><span class="line">thresholdUpStopLoss_co = mean_co+<span class="number">2.5</span>*sd_co</span><br><span class="line">thresholdDownStopLoss_co = mean_co-<span class="number">2.5</span>*sd_co</span><br><span class="line">spreadf.describe()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/24.png" alt="24"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 画出形成期中国银行与浦发银行价差序列</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>) </span><br><span class="line">spreadf.plot(label=<span class="string">&#x27;价差序列&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;形成期中国银行与浦发银行价差序列(协整配对)&#x27;</span>) </span><br><span class="line">plt.axhline(y=mean_co, color=<span class="string">&#x27;black&#x27;</span>, label=<span class="string">&#x27;均值&#x27;</span>)  </span><br><span class="line">plt.axhline(y=thresholdUpOpen_co, color=<span class="string">&#x27;green&#x27;</span>, label=<span class="string">&#x27;开仓线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownOpen_co, color=<span class="string">&#x27;green&#x27;</span>) </span><br><span class="line">plt.axhline(y=thresholdUpClose_co, color=<span class="string">&#x27;red&#x27;</span>, label=<span class="string">&#x27;平仓线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownClose_co, color=<span class="string">&#x27;red&#x27;</span>) </span><br><span class="line">plt.axhline(y=thresholdUpStopLoss_co, color=<span class="string">&#x27;blue&#x27;</span>, label=<span class="string">&#x27;止损线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownStopLoss_co, color=<span class="string">&#x27;blue&#x27;</span>) </span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/25.png" alt="25"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算交易期协整配对价差序列</span></span><br><span class="line">tradStart = <span class="string">&#x27;2015-01-01&#x27;</span></span><br><span class="line">tradEnd = <span class="string">&#x27;2015-06-30&#x27;</span></span><br><span class="line">PXt = sh.loc[tradStart:tradEnd,<span class="string">&#x27;601988&#x27;</span>]</span><br><span class="line">PYt = sh.loc[tradStart:tradEnd,<span class="string">&#x27;600000&#x27;</span>]</span><br><span class="line"></span><br><span class="line">CoSpreadT = np.log(PYt)-beta*np.log(PXt)-alpha</span><br><span class="line">CoSpreadT.describe()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/26.png" alt="26"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>) </span><br><span class="line">CoSpreadT.plot(label=<span class="string">&#x27;价差序列&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;交易期中国银行与浦发银行价差序列(协整配对)&#x27;</span>) </span><br><span class="line">plt.axhline(y=mean_co, color=<span class="string">&#x27;black&#x27;</span>, label=<span class="string">&#x27;均值&#x27;</span>)  </span><br><span class="line">plt.axhline(y=thresholdUpOpen_co, color=<span class="string">&#x27;green&#x27;</span>, label=<span class="string">&#x27;开仓线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownOpen_co, color=<span class="string">&#x27;green&#x27;</span>) </span><br><span class="line">plt.axhline(y=thresholdUpClose_co, color=<span class="string">&#x27;red&#x27;</span>, label=<span class="string">&#x27;平仓线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownClose_co, color=<span class="string">&#x27;red&#x27;</span>) </span><br><span class="line">plt.axhline(y=thresholdUpStopLoss_co, color=<span class="string">&#x27;blue&#x27;</span>, label=<span class="string">&#x27;止损线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownStopLoss_co, color=<span class="string">&#x27;blue&#x27;</span>) </span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/27.png" alt="27"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 协整配对策略的执行</span></span><br><span class="line"><span class="comment"># 设置价差所处区间</span></span><br><span class="line">level=(<span class="built_in">float</span>(<span class="string">&#x27;-inf&#x27;</span>), thresholdDownStopLoss_co, thresholdDownOpen_co, thresholdDownClose_co, thresholdUpClose_co, thresholdUpOpen_co, thresholdUpStopLoss_co, <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">round</span>(level,<span class="number">3</span>))</span><br><span class="line">prcLevel = pd.cut(CoSpreadT, level, labels=<span class="literal">False</span>)-<span class="number">3</span> <span class="comment"># 返回价差所处区间，记均值附近0.2个标准差区间为0区，</span></span><br><span class="line">                                                    <span class="comment"># 向上依次1，2，3区，向下依次为-1,-2,-3区</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">prcLevel.plot.bar(label=<span class="string">&#x27;价差所处区间&#x27;</span>) </span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/28.png" alt="28"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义交易信号函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">TradeSig1</span>(<span class="params">CoSpreadT</span>):</span><br><span class="line">    n=<span class="built_in">len</span>(CoSpreadT)</span><br><span class="line">    signal=np.zeros(n,dtype=np.int16)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">        <span class="keyword">if</span> CoSpreadT[i-<span class="number">1</span>]&lt;=thresholdUpOpen_co <span class="keyword">and</span> CoSpreadT[i]&gt;thresholdUpOpen_co: <span class="comment"># 向上突破开仓线</span></span><br><span class="line">            <span class="keyword">if</span> CoSpreadT[i]&lt;=thresholdUpStopLoss_co: <span class="comment">#未达到向上止损线，如之前未开仓则开仓</span></span><br><span class="line">                signal[i]=-<span class="number">2</span> <span class="comment"># Y相对X较高，卖空Y买入X</span></span><br><span class="line">            <span class="keyword">else</span>:        <span class="comment"># 向上突破止损线，如之前开仓则平仓止损</span></span><br><span class="line">                signal[i]=<span class="number">3</span>        </span><br><span class="line">        <span class="keyword">elif</span> CoSpreadT[i-<span class="number">1</span>]&gt;=thresholdUpClose_co <span class="keyword">and</span> CoSpreadT[i]&lt;thresholdUpClose_co: <span class="comment"># 向下突破平仓线</span></span><br><span class="line">            <span class="keyword">if</span> CoSpreadT[i]&gt;=thresholdDownOpen_co: <span class="comment">#未达到向下开仓线，如之前开仓则平仓</span></span><br><span class="line">                signal[i]=<span class="number">2</span></span><br><span class="line">            <span class="keyword">elif</span> CoSpreadT[i]&gt;=thresholdDownStopLoss_co: <span class="comment"># 达到向下开仓线但未达到向下止损线，如之前未开仓则开仓</span></span><br><span class="line">                signal[i]=<span class="number">1</span> <span class="comment"># Y相对X较低，买入Y卖空X</span></span><br><span class="line">            <span class="keyword">else</span>:       <span class="comment"># 向下突破止损线，如之前开仓则平仓止损</span></span><br><span class="line">                signal[i]=-<span class="number">3</span>            </span><br><span class="line">        <span class="keyword">elif</span> CoSpreadT[i-<span class="number">1</span>]&lt;=thresholdUpStopLoss_co <span class="keyword">and</span> CoSpreadT[i]&gt;thresholdUpStopLoss_co: </span><br><span class="line">            <span class="comment"># 向上突破止损线，如之前开仓则平仓止损</span></span><br><span class="line">            signal[i]=<span class="number">3</span></span><br><span class="line">        <span class="keyword">elif</span> CoSpreadT[i-<span class="number">1</span>]&gt;=thresholdDownOpen_co <span class="keyword">and</span> CoSpreadT[i]&lt;thresholdDownOpen_co: <span class="comment"># 向下突破开仓线</span></span><br><span class="line">            <span class="keyword">if</span> CoSpreadT[i]&gt;=thresholdDownStopLoss_co:  <span class="comment"># 未达到向下止损线，如之前未开仓则开仓</span></span><br><span class="line">                signal[i]=<span class="number">1</span> <span class="comment"># Y相对X较低，买入Y卖空X</span></span><br><span class="line">            <span class="keyword">else</span>: <span class="comment"># 向下突破止损线，如之前开仓则平仓止损</span></span><br><span class="line">                signal[i]=-<span class="number">3</span>                </span><br><span class="line">        <span class="keyword">elif</span> CoSpreadT[i-<span class="number">1</span>]&lt;=thresholdDownClose_co <span class="keyword">and</span> CoSpreadT[i]&gt;thresholdDownClose_co: <span class="comment"># 向上突破平仓线</span></span><br><span class="line">            <span class="keyword">if</span> CoSpreadT[i]&lt;=thresholdUpOpen_co: <span class="comment"># 未达到向上开仓线，如之前开仓则平仓</span></span><br><span class="line">                signal[i]=-<span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> CoSpreadT[i]&lt;=thresholdUpStopLoss_co: <span class="comment">#达到向上开仓线但未达到向上止损线，如之前未开仓则开仓</span></span><br><span class="line">                signal[i]=-<span class="number">2</span> <span class="comment"># Y相对X较高，卖空Y买入X</span></span><br><span class="line">            <span class="keyword">else</span>:<span class="comment"># 向上突破止损线，如之前开仓则平仓止损</span></span><br><span class="line">                signal[i]=<span class="number">3</span> </span><br><span class="line">        <span class="keyword">elif</span> CoSpreadT[i-<span class="number">1</span>]&gt;=thresholdDownStopLoss_co <span class="keyword">and</span> CoSpreadT[i]&lt;thresholdDownStopLoss_co:</span><br><span class="line">            <span class="comment"># 向下突破止损线，如之前开仓则平仓止损</span></span><br><span class="line">            signal[i]=-<span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span>(signal)</span><br><span class="line"></span><br><span class="line">signal1=TradeSig1(CoSpreadT)</span><br><span class="line"><span class="comment"># plt.plot(prcLevel.index,signal,label=&#x27;交易信号&#x27;)</span></span><br><span class="line"><span class="comment"># plt.legend()</span></span><br><span class="line">ua1,uind1=np.unique(signal1,return_counts=<span class="literal">True</span>) </span><br><span class="line"><span class="built_in">print</span>(ua1,<span class="string">&#x27;\n&#x27;</span>,uind1)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/29.png" alt="29"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">TradePosition</span>(<span class="params">signal</span>):</span><br><span class="line">    position=[signal[<span class="number">0</span>]]</span><br><span class="line">    ns=<span class="built_in">len</span>(signal)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,ns):</span><br><span class="line">        position.append(position[-<span class="number">1</span>]) <span class="comment"># 如果下面的判断语句都为否，则仓位与上一时间相同</span></span><br><span class="line">        <span class="keyword">if</span> signal[i]==<span class="number">1</span>: <span class="comment"># 向下突破开仓线，如之前已开仓则不操作保持开仓；如之前未开仓则开仓 （买入浦发银行、卖出中国银行）</span></span><br><span class="line">            position[i]=<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> signal[i]==-<span class="number">2</span>:  <span class="comment"># 向上突破开仓线，如之前已开仓则不操作保持开仓；如之前未开仓则开仓（卖出浦发银行、买入中国银行）</span></span><br><span class="line">            position[i]=-<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> signal[i]==-<span class="number">1</span>: <span class="comment"># and position[i-1]==1: # 从-1区到0区，向上突破平仓线，如之前开仓（从-1区到-2区开仓position[i-1]==1）则平仓</span></span><br><span class="line">            position[i]=<span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> signal[i]==<span class="number">2</span>: <span class="comment"># and position[i-1]==-1: # 从1区到0区，向下突破平仓线，如之前开仓（从1区到2区开仓position[i-1]==-1）则平仓</span></span><br><span class="line">            position[i]=<span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> signal[i]==<span class="number">3</span>: <span class="comment"># 从2区到3区，向上突破止损线，平仓止损</span></span><br><span class="line">            position[i]=<span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> signal[i]==-<span class="number">3</span>: <span class="comment"># 从-2区到-3区，向下突破止损线，平仓止损</span></span><br><span class="line">            position[i]=<span class="number">0</span></span><br><span class="line">    position=pd.Series(position,index=prcLevel.index)</span><br><span class="line">    <span class="keyword">return</span>(position)</span><br><span class="line">position1=TradePosition(signal1)</span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)  </span><br><span class="line">plt.plot(position1.index,position1,label=<span class="string">&#x27;交易仓位（买入浦发银行、卖出中国银行）&#x27;</span>)</span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/30.png" alt="30"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义交易账户函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">TradeSimCoI</span>(<span class="params">priceX,priceY,position</span>):</span><br><span class="line">    n=<span class="built_in">len</span>(position)</span><br><span class="line">    size=<span class="number">1000</span></span><br><span class="line">    shareY=size*position </span><br><span class="line">    shareX=[(-beta)*shareY[<span class="number">0</span>]*priceY[<span class="number">0</span>]/priceX[<span class="number">0</span>]] <span class="comment"># 双边建仓</span></span><br><span class="line">    <span class="comment"># -beta=moneyX/moneyY=(priceX*shareX)/(priceY*shareY)</span></span><br><span class="line">    <span class="comment"># shareX=-beta*(priceY*shareY)/priceX</span></span><br><span class="line">    opencashunbalance=-(shareX[<span class="number">0</span>]*priceX[<span class="number">0</span>]+shareY[<span class="number">0</span>]*priceY[<span class="number">0</span>])     </span><br><span class="line">    cash=[<span class="number">20000</span>+opencashunbalance]    </span><br><span class="line">    closecashunbalance=<span class="number">0</span></span><br><span class="line">    TradeDate=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">        shareX.append(shareX[i-<span class="number">1</span>]) <span class="comment"># 如果下面的判断语句都为否，则仓位与上一时间相同</span></span><br><span class="line">        cash.append(cash[i-<span class="number">1</span>])     <span class="comment"># 如果没有新的开仓平仓操作，则现金与上一时间相同</span></span><br><span class="line">        <span class="keyword">if</span> position[i-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> position[i]==<span class="number">1</span>: <span class="comment">#新开仓</span></span><br><span class="line">            shareX[i]=(-beta)*shareY[i]*priceY[i]/priceX[i]</span><br><span class="line">            opencashunbalance=-(shareY[i]*priceY[i]+shareX[i]*priceX[i])</span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+opencashunbalance</span><br><span class="line">            TradeDate.append(priceX.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(priceX.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：买入 %.2f 元浦发银行股票，同时卖空 %.2f 元中国银行股票，现金账户增加 %.2f 元  &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),shareY[i]*priceY[i],-shareX[i]*priceX[i],opencashunbalance))</span><br><span class="line">        <span class="keyword">elif</span> position[i-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> position[i]==-<span class="number">1</span>:</span><br><span class="line">            shareX[i]=(-beta)*shareY[i]*priceY[i]/priceX[i]</span><br><span class="line">            opencashunbalance=-(shareY[i]*priceY[i]+shareX[i]*priceX[i]) <span class="comment"># long-short unbalance</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+opencashunbalance</span><br><span class="line">            TradeDate.append(priceX.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(priceX.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：卖空 %.2f 元浦发银行股票，同时买入 %.2f元中国银行股票，现金账户增加 %.2f 元 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),-shareY[i]*priceY[i],shareX[i]*priceX[i],opencashunbalance))</span><br><span class="line">        <span class="keyword">elif</span> position[i-<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> position[i]==<span class="number">0</span>:</span><br><span class="line">            shareX[i]=<span class="number">0</span></span><br><span class="line">            closecashunbalance=(shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i])</span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+closecashunbalance</span><br><span class="line">            TradeDate.append(priceX.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(priceX.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：卖出  %.2f 元浦发银行股票，同时买入  %.2f 中国银行股票（平仓中国银行空头）: 获利  %.2f 元 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),shareY[i-<span class="number">1</span>]*priceY[i],-shareX[i-<span class="number">1</span>]*priceX[i],\</span><br><span class="line">                     closecashunbalance+opencashunbalance ))</span><br><span class="line">        <span class="keyword">elif</span> position[i-<span class="number">1</span>]==-<span class="number">1</span> <span class="keyword">and</span> position[i]==<span class="number">0</span>:</span><br><span class="line">            shareX[i]=<span class="number">0</span></span><br><span class="line">            closecashunbalance=(shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i])</span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+closecashunbalance</span><br><span class="line">            TradeDate.append(priceX.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(priceX.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：买入  %.2f 元浦发银行股票（平仓浦发银行空头），同时卖出  %.2f 中国银行股票: 获利  %.2f 元 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),-shareY[i-<span class="number">1</span>]*priceY[i],shareX[i-<span class="number">1</span>]*priceX[i],\</span><br><span class="line">                     closecashunbalance+opencashunbalance ))</span><br><span class="line">        <span class="keyword">elif</span> position[i-<span class="number">1</span>]==-<span class="number">1</span> <span class="keyword">and</span> position[i]==<span class="number">1</span>:</span><br><span class="line">            <span class="comment"># 先平仓 position: -1--&gt;0</span></span><br><span class="line">            closecashunbalance=(shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i])</span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+closecashunbalance</span><br><span class="line">            TradeDate.append(priceX.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(priceX.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：买入  %.2f 元浦发银行股票（平仓浦发银行空头），同时卖出  %.2f 中国银行股票: 获利  %.2f 元 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),-shareY[i-<span class="number">1</span>]*priceY[i],shareX[i-<span class="number">1</span>]*priceX[i],\</span><br><span class="line">                     closecashunbalance+opencashunbalance ))</span><br><span class="line">            <span class="comment"># 再反向开仓 position: 0--&gt;1</span></span><br><span class="line">            shareX[i]=(-beta)*shareY[i]*priceY[i]/priceX[i]</span><br><span class="line">            opencashunbalance=-(shareY[i]*priceY[i]+shareX[i]*priceX[i])</span><br><span class="line">            cash[i]=cash[i]+opencashunbalance</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：买入 %.2f 元浦发银行股票，同时卖空 %.2f 元中国银行股票，现金账户增加 %.2f 元  &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),shareY[i]*priceY[i],-shareX[i]*priceX[i],opencashunbalance))</span><br><span class="line">        <span class="keyword">elif</span> position[i-<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> position[i]==-<span class="number">1</span>:</span><br><span class="line">            <span class="comment"># 先平仓 position: 1--&gt;0</span></span><br><span class="line">            closecashunbalance=(shareY[i-<span class="number">1</span>]*priceY[i]+shareX[i-<span class="number">1</span>]*priceX[i])</span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+closecashunbalance</span><br><span class="line">            TradeDate.append(priceX.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(priceX.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：卖出  %.2f 元浦发银行股票，同时买入  %.2f 中国银行股票（平仓中国银行空头）: 获利  %.2f 元 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),shareY[i-<span class="number">1</span>]*priceY[i],-shareX[i-<span class="number">1</span>]*priceX[i],\</span><br><span class="line">                     closecashunbalance+opencashunbalance ))</span><br><span class="line">            <span class="comment"># 再反向开仓 position: 0--&gt;-1</span></span><br><span class="line">            shareX[i]=(-beta)*shareY[i]*priceY[i]/priceX[i]</span><br><span class="line">            opencashunbalance=-(shareY[i]*priceY[i]+shareX[i]*priceX[i]) <span class="comment"># long-short unbalance</span></span><br><span class="line">            cash[i]=cash[i]+opencashunbalance</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：卖空 %.2f 元浦发银行股票，同时买入 %.2f元中国银行股票，现金账户增加 %.2f 元 &#x27;</span>\</span><br><span class="line">                  % (priceX.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),-shareY[i]*priceY[i],shareX[i]*priceX[i],opencashunbalance))</span><br><span class="line">            </span><br><span class="line">    cash = pd.Series(cash,index=position.index)</span><br><span class="line">    shareY=pd.Series(shareY,index=position.index)</span><br><span class="line">    shareX=pd.Series(shareX,index=position.index)</span><br><span class="line">    stockvalue=shareY*priceY+shareX*priceX</span><br><span class="line">    asset=cash+stockvalue</span><br><span class="line">    account=pd.DataFrame(&#123;<span class="string">&#x27;Position&#x27;</span>:position,<span class="string">&#x27;ShareY&#x27;</span>:shareY,<span class="string">&#x27;PriceY&#x27;</span>:priceY,<span class="string">&#x27;ValueY&#x27;</span>:shareY*priceY,<span class="string">&#x27;ShareX&#x27;</span>:shareX,\</span><br><span class="line">                          <span class="string">&#x27;PriceX&#x27;</span>:priceX,<span class="string">&#x27;ValueX&#x27;</span>:shareX*priceX,<span class="string">&#x27;StockValue&#x27;</span>:stockvalue,<span class="string">&#x27;Cash&#x27;</span>:cash,<span class="string">&#x27;Asset&#x27;</span>:asset,&#125;)</span><br><span class="line">    TradeDates=[] <span class="comment"># 删除列表TradeDate中重复的日期</span></span><br><span class="line">    <span class="keyword">for</span> date <span class="keyword">in</span> TradeDate:</span><br><span class="line">        <span class="keyword">if</span> date <span class="keyword">not</span> <span class="keyword">in</span> TradeDates:</span><br><span class="line">            TradeDates.append(date)</span><br><span class="line">    <span class="keyword">return</span>(account, TradeDates)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 交易记录</span></span><br><span class="line">account1, TradeDates = TradeSimCoI(PXt, PYt, position1) <span class="comment">#.dropna()</span></span><br><span class="line">account1.to_csv(<span class="string">&#x27;CoI.csv&#x27;</span>)</span><br><span class="line"><span class="built_in">format</span> = <span class="keyword">lambda</span> x:<span class="string">&#x27;%.2f&#x27;</span> % x</span><br><span class="line">account1.applymap(<span class="built_in">format</span>).loc[TradeDates] <span class="comment">#保留两位小数输出</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/31.png" alt="31"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 画出2015年上半年中国银行与浦发银行价格走势图</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)  </span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>]=[<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>]=<span class="literal">False</span></span><br><span class="line">plt.plot(PXt,<span class="string">&#x27;g&#x27;</span>,label=<span class="string">&#x27;601988（中国银行）&#x27;</span>)</span><br><span class="line">plt.plot(PYt,<span class="string">&#x27;b--&#x27;</span>,label=<span class="string">&#x27;600000（浦发银行）&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;2015年上半年中国银行与浦发银行价格走势图&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;日期&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;股价&#x27;</span>)</span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/32.png" alt="32"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#画出交易账户仓位和资产序列 </span></span><br><span class="line">account1.loc[:,(<span class="string">&#x27;ShareY&#x27;</span>,<span class="string">&#x27;Cash&#x27;</span>,<span class="string">&#x27;Asset&#x27;</span>)].plot(style=[<span class="string">&#x27;--&#x27;</span>,<span class="string">&#x27;:&#x27;</span>],color=[<span class="string">&#x27;black&#x27;</span>,<span class="string">&#x27;blue&#x27;</span>,<span class="string">&#x27;red&#x27;</span>],figsize=(<span class="number">20</span>,<span class="number">8</span>))</span><br><span class="line">plt.title(<span class="string">&#x27;配对交易账户&#x27;</span>) </span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/33.png" alt="33"></p>
<h1 id="随机价差法"><a class="markdownIt-Anchor" href="#随机价差法"></a> 随机价差法</h1>
<ul>
<li>
<p>Robert，Hoek and Malcolm (2005)假设配对股票价差满足一个（离散）均值回归模型</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>−</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></msub><mo>=</mo><mi>κ</mi><mo stretchy="false">(</mo><mi>α</mi><mo>−</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>+</mo><mi>σ</mi><msqrt><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></msqrt><msub><mi>ϵ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_{t}-x_{t-\Delta t}=\kappa(\alpha- x_{t-\Delta t}) \Delta t + \sigma \sqrt{\Delta t} \epsilon_t  
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">Δ</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">κ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">Δ</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">Δ</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.12554em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9755400000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">Δ</span><span class="mord mathdefault">t</span></span></span><span style="top:-2.93554em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.06445999999999996em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
</li>
<li>
<p>它的连续形式为（随机微分方程：OU过程）<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><mi>κ</mi><mo stretchy="false">(</mo><mi>α</mi><mo>−</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mi>d</mi><mi>t</mi><mo>+</mo><mi>σ</mi><mi>d</mi><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
d x_{t} =\kappa(\alpha- x_{t}) d t + \sigma d W_t  
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">κ</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">d</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mord mathdefault">d</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">W_t, t\geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 是一个标准的布朗运动(Brownian motion)</p>
<ul>
<li>通过极大似然估计方法估计参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>κ</mi><mo separator="true">,</mo><mi>α</mi><mo separator="true">,</mo><mi>σ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\kappa,\alpha,\sigma)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">κ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span></span></span></span> : 最大化（对数）似然函数</li>
</ul>
</li>
</ul>
 \begin{align*}
\max_{\kappa,\alpha,\sigma} &\sum_{t=1}^T \log p(x_{t}|x_{t-\Delta t},\Delta t),\\
 \quad where \quad & p(x_{t}|x_{t-\Delta t},\Delta t)=\frac{1}{\sqrt{2\pi \hat{\sigma}^2}}exp\left(-\frac{(x_{t}-\hat{\mu})}{2  \hat{\sigma}^2}\right)\\
    & \hat{\mu}=\alpha+(x_{t-\Delta t}-\alpha) exp(-\kappa \Delta t), \\
    &\hat{\sigma}^2=\frac{\sigma^2}{2\kappa}(1-exp(-2\kappa\Delta t))
\end{align*}

<p>其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span> 为OU过程的转移密度</p>
<h1 id="时间序列的预处理"><a class="markdownIt-Anchor" href="#时间序列的预处理"></a> 时间序列的预处理</h1>
<h2 id="1-判断序列是否为平稳序列adf检验如果为非平稳序列进行变换转化为平稳序列"><a class="markdownIt-Anchor" href="#1-判断序列是否为平稳序列adf检验如果为非平稳序列进行变换转化为平稳序列"></a> 1. 判断序列是否为平稳序列（ADF检验），如果为非平稳序列，进行变换转化为平稳序列</h2>
<ul>
<li>如果一个非平稳时间序列经差分运算后具有平稳性，则该序列为差分平稳序列，可以使用ARIMA模型进行分析。</li>
</ul>
<h2 id="2-如果序列为平稳序列检验是否为白噪声序列ljung-box检验检验序列的各项之间有没有自相关性如果为白噪音可以终止对该序列的分析-白噪声序列是没有信息可提取的平稳序列"><a class="markdownIt-Anchor" href="#2-如果序列为平稳序列检验是否为白噪声序列ljung-box检验检验序列的各项之间有没有自相关性如果为白噪音可以终止对该序列的分析-白噪声序列是没有信息可提取的平稳序列"></a> 2. 如果序列为平稳序列，检验是否为白噪声序列(Ljung-Box检验，检验序列的各项之间有没有自相关性)，如果为白噪音，可以终止对该序列的分析。白噪声序列是没有信息可提取的平稳序列。</h2>
<h2 id="3-如果平稳序列为非白噪声序列可以考虑建立armapq模型aic或者bic标准选取pq"><a class="markdownIt-Anchor" href="#3-如果平稳序列为非白噪声序列可以考虑建立armapq模型aic或者bic标准选取pq"></a> 3. 如果平稳序列为非白噪声序列，可以考虑建立ARMA(p,q)模型(AIC或者BIC标准选取p,q)</h2>
<ul>
<li>对于已建立的ARMA(p,q)模型，检验残差是否为高斯白噪音过程，如果是，建模结束，序列的信息已充分提取到模型中</li>
<li>如果ARMA(p,q)模型的残差不是正态分布（比如有尖峰厚尾），检验残差的平方是否具有自相关性，如有考虑建立ARCH或者GARCH模型。</li>
</ul>
<h1 id="时间序列分析流程图"><a class="markdownIt-Anchor" href="#时间序列分析流程图"></a> 时间序列分析流程图</h1>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/34.png" alt="34"></p>
<h1 id="自回归模型autoregressive-model-ar模型"><a class="markdownIt-Anchor" href="#自回归模型autoregressive-model-ar模型"></a> 自回归模型（Autoregressive Model, AR模型）</h1>
<ul>
<li>
<p><span style="color:red">AR(1)模型</span>： 收益率 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>关于它的历史序列<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">r_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>做线性回归<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>ϕ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>ϕ</mi><mn>1</mn></msub><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\large r_t=\phi_0+\phi_1 r_{t-1}+\varepsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0799919999999998em;vertical-align:-0.246664em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.6499999999999995em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20555333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϕ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>ϕ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\phi_0,\phi_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是回归系数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ε</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\varepsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是一个均值为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>方差为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>的白噪声序列。假设其为弱稳态过程，则</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>=</mo><msub><mi>ϕ</mi><mn>0</mn></msub><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mu=E[r_t]=\phi_0/(1-\phi_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li>$r_t-\mu= \phi_1(r_{t-1}-\mu)+\varepsilon_{t}, \ldots, r_t-\mu=\sum_{i=0}^\infty \phi_1^i\varepsilon_{t-i} $</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>=</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>=</mo><msup><mi>σ</mi><mn>2</mn></msup><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>ϕ</mi><mn>1</mn><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma^2=Var[r_t]=\sigma^2/(1-\phi_1^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. AR(1)弱平稳当且仅当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>ϕ</mi><mn>1</mn></msub><mi mathvariant="normal">∣</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|\phi_1|&lt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li>
<li>自协方差<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>γ</mi><mi>l</mi></msub><mo>=</mo><msub><mi>ϕ</mi><mn>1</mn></msub><msub><mi>γ</mi><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\gamma_l=\phi_1 \gamma_{l-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">l&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></li>
<li>自相关系数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mi>l</mi></msub><mo>=</mo><msub><mi>γ</mi><mi>l</mi></msub><mi mathvariant="normal">/</mi><msub><mi>γ</mi><mn>0</mn></msub><mo>=</mo><msub><mi>ϕ</mi><mn>1</mn></msub><msub><mi>ρ</mi><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\rho_l=\gamma_l/\gamma_0=\phi_1 \rho_{l-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> 当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">l&gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>,拖尾（几何型或震荡型）</li>
</ul>
</li>
<li>
<p><span style="color:red">AR§模型</span>： 收益率 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>关于它的历史序列<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>ϕ</mi><mi>p</mi></msub><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">r_{t-1},\cdots,\phi_p r_{t-p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28055599999999997em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>做线性回归<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>ϕ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>ϕ</mi><mn>1</mn></msub><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>ϕ</mi><mi>p</mi></msub><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mi>p</mi></mrow></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\large r_t=\phi_0+\phi_1 r_{t-1}+\cdots+\phi_p r_{t-p} +\varepsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0799919999999998em;vertical-align:-0.246664em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.6499999999999995em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20555333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7999919999999999em;vertical-align:-0.099996em;"></span><span class="minner sizing reset-size6 size7">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.16888em;vertical-align:-0.335552em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.13704000000000005em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ϕ</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>ϕ</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>ϕ</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\phi_0,\phi_1,\cdots,\phi_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>是回归系数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ε</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\varepsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是一个白噪声序列。</p>
<ul>
<li>自相关系数ACF: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mi>l</mi></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></msubsup><msub><mi>ϕ</mi><mi>i</mi></msub><msub><mi>ρ</mi><mrow><mi>l</mi><mo>−</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\rho_l=\sum_{i=1}^p \phi_i \rho_{l-i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029000000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> 当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>≥</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">l\geq p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span>,拖尾（几何型或震荡型）</li>
<li>AR模型的识别：偏自相关系数PACF: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mrow><mi>l</mi><mi>l</mi></mrow></msub><mo>:</mo><mo>=</mo><mi>C</mi><mi>o</mi><mi>r</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>r</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mi>l</mi></mrow></msub><mi mathvariant="normal">∣</mi><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho_{ll}:=Corr(r_t,r_{t-l}|r_{t-1},\cdots,r_{t-l+1})\rightarrow 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>&gt;</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">l&gt; q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>,截尾</li>
<li><code>statsmodels.tsa.stattools.pacf()</code> 计算时间序列的偏自相关系数</li>
</ul>
</li>
</ul>
<h1 id="移动平均模型moving-average-ma模型"><a class="markdownIt-Anchor" href="#移动平均模型moving-average-ma模型"></a> 移动平均模型（Moving-Average, MA模型）</h1>
<ul>
<li>
<p><span style="color:red">MA(1)模型</span>： 收益率 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>受到当前以及一阶滞后的随机冲击项影响<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mi>μ</mi><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub><mo>+</mo><msub><mi>θ</mi><mn>1</mn></msub><msub><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\large r_t=\mu+\varepsilon_t+\theta_1 \varepsilon_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9333239999999999em;vertical-align:-0.23332799999999998em;"></span><span class="mord mathdefault sizing reset-size6 size7">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.879996em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0799919999999998em;vertical-align:-0.246664em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.6499999999999995em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20555333333333334em;"><span></span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\mu,\theta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是回归系数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ε</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\varepsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是一个均值为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>方差为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>的白噪声序列。</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi><mo stretchy="false">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mi>μ</mi></mrow><annotation encoding="application/x-tex">E[r_t]=\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msubsup><mi>θ</mi><mn>1</mn><mn>2</mn></msubsup><mo stretchy="false">)</mo><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">Var[r_t]=(1+\theta_1^2)\sigma^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>.</li>
<li>自协方差<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo>=</mo><mi>C</mi><mi>o</mi><mi>v</mi><mo stretchy="false">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">]</mo><mo>=</mo><msub><mi>θ</mi><mn>1</mn></msub><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\gamma_1=Cov[r_t,r_{t-1}]=\theta_1 \sigma^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>γ</mi><mi>l</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma_l=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05556em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l &gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>, 为常数，MA模型一定为弱平稳过程</li>
<li>自相关系数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><mo separator="true">;</mo><msub><mi>ρ</mi><mn>1</mn></msub><mo>=</mo><msub><mi>θ</mi><mn>1</mn></msub><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msubsup><mi>θ</mi><mn>1</mn><mn>2</mn></msubsup><mo stretchy="false">)</mo><mo separator="true">;</mo><msub><mi>ρ</mi><mi>l</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho_0=1; \rho_1=\theta_1/(1+\theta_1^2); \rho_l=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l &gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，截尾</li>
</ul>
</li>
<li>
<p><span style="color:red">MA(q)模型</span>：<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mi>μ</mi><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub><mo>+</mo><msub><mi>θ</mi><mn>1</mn></msub><msub><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>θ</mi><mi>q</mi></msub><msub><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mi>q</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\large r_t=\mu+\varepsilon_t+\theta_1 \varepsilon_{t-1}+\cdots+\theta_q \varepsilon_{t-q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9333239999999999em;vertical-align:-0.23332799999999998em;"></span><span class="mord mathdefault sizing reset-size6 size7">μ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.879996em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0799919999999998em;vertical-align:-0.246664em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.6499999999999995em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20555333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7999919999999999em;vertical-align:-0.099996em;"></span><span class="minner sizing reset-size6 size7">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.16888em;vertical-align:-0.335552em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.13704000000000005em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span></span></span></span>,  其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi><mo separator="true">,</mo><msub><mi>θ</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>θ</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">\mu,\theta_1,\cdots,\theta_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">μ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>是回归系数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ε</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\varepsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是一个白噪声序列。</p>
<ul>
<li>MA模型的识别：自相关系数ACF: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ρ</mi><mi>l</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\rho_l=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>&gt;</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">l&gt;q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>,</li>
<li>偏自相关系数PACF:   拖尾（几何型或震荡型）</li>
</ul>
</li>
</ul>
<h1 id="自回归移动平均模型autoregressive-moving-average-arma模型"><a class="markdownIt-Anchor" href="#自回归移动平均模型autoregressive-moving-average-arma模型"></a> 自回归移动平均模型（Autoregressive Moving-Average, ARMA模型）</h1>
<ul>
<li><span style="color:red">ARMA(p,q)模型</span>：<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>ϕ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>ϕ</mi><mn>1</mn></msub><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>ϕ</mi><mi>p</mi></msub><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mi>p</mi></mrow></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub><mo>+</mo><msub><mi>θ</mi><mn>1</mn></msub><msub><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>θ</mi><mi>q</mi></msub><msub><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mi>q</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\large r_t=\phi_0+\phi_1 r_{t-1}+\cdots+\phi_p r_{t-p}+\varepsilon_t+\theta_1 \varepsilon_{t-1}+\cdots+\theta_q \varepsilon_{t-q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0799919999999998em;vertical-align:-0.246664em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.6499999999999995em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20555333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7999919999999999em;vertical-align:-0.099996em;"></span><span class="minner sizing reset-size6 size7">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.16888em;vertical-align:-0.335552em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.13704000000000005em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.879996em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0799919999999998em;vertical-align:-0.246664em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.6499999999999995em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20555333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7999919999999999em;vertical-align:-0.099996em;"></span><span class="minner sizing reset-size6 size7">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.16888em;vertical-align:-0.335552em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.13704000000000005em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span></span></span></span>
<ul>
<li>自相关系数ACF和偏自相关系数PACF都是拖尾（几何型或震荡型）</li>
<li>ARMA(p,q)模型的ACF与AR§相似,指数衰减</li>
<li>ARMA(p,q)模型的PACF与MA(q)相似,指数衰减</li>
<li>ARMA(p,q)模型的识别：AIC,BIC准则</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 大唐电信日收益率的平ARMA(p,q)建模</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取形成期数据</span></span><br><span class="line">Datang = pd.read_csv(<span class="string">&#x27;Datang.csv&#x27;</span>, index_col=<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">Datang.index = pd.to_datetime(Datang.index)</span><br><span class="line">Datang.head()</span><br><span class="line">returns = Datang.datang[<span class="string">&#x27;2014-01-01&#x27;</span>:<span class="string">&#x27;2016-01-01&#x27;</span>]</span><br><span class="line">returns.plot(figsize=(<span class="number">20</span>,<span class="number">8</span>))</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/35.png" alt="35"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 平稳性检验</span></span><br><span class="line">ADF(returns).summary()</span><br><span class="line"><span class="comment"># 结果显示大唐电信2014-2015年的日收益率序列是平稳的</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/36.png" alt="36"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 白噪声检验</span></span><br><span class="line">stattools.q_stat(stattools.acf(returns, nlags=<span class="number">12</span>, fft=<span class="literal">False</span>)[<span class="number">1</span>:<span class="number">12</span>], <span class="built_in">len</span>(returns))[<span class="number">1</span>]  <span class="comment"># P-value of the Ljung-Box Q statistic</span></span><br><span class="line"><span class="comment"># 结果显示大唐电信2014-2015年的日收益率序列是不是白噪声</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/37.png" alt="37"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 画出日收益率序列的ACF和PACF图</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将画面一分为二</span></span><br><span class="line">axe1 = plt.subplot(<span class="number">211</span>)</span><br><span class="line">axe2 = plt.subplot(<span class="number">212</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在第一个画面中画出序列的自相关系数图 </span></span><br><span class="line">plot1 = plot_acf(returns, lags=<span class="number">12</span>, ax=axe1)</span><br><span class="line"><span class="comment"># 在第二个画面中画出序列的偏自相关系数图</span></span><br><span class="line">plot2 = plot_pacf(returns, lags=<span class="number">12</span>, ax=axe2)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/38.png" alt="38"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过BIC准则选择ARMA(p,q)模型的阶数</span></span><br><span class="line">order_select = stattools.arma_order_select_ic(returns, max_ma=<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/39.png" alt="39"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(order_select[<span class="string">&#x27;bic_min_order&#x27;</span>])  <span class="comment"># 输出最小BIC的(p, q)对</span></span><br><span class="line">order_select[<span class="string">&#x27;bic&#x27;</span>]  <span class="comment"># 各(p, q)对 对应的BIC值</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/40.png" alt="40"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> statsmodels.tsa <span class="keyword">import</span> arima_model</span><br><span class="line">model1 = arima_model.ARIMA(returns, order=(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>)).fit()</span><br><span class="line">model1.summary()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/41.png" alt="41"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from statsmodels.tsa import arima_model</span></span><br><span class="line"><span class="comment"># model=arima_model.ARIMA(returns,order=(1,0,0)).fit()</span></span><br><span class="line"><span class="keyword">from</span> statsmodels.tsa <span class="keyword">import</span> arima</span><br><span class="line"><span class="comment"># order表示建立的模型的阶数，c(1,0,0)表示建立的是ARMA(1,0)模型；</span></span><br><span class="line"><span class="comment"># 中间的数字0表示使用原始的、未进行过差分（差分次数为0）的数据；</span></span><br><span class="line"><span class="comment"># 此处我们无需考虑它</span></span><br><span class="line">model1 = arima.model.ARIMA(returns, order=(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>)).fit() <span class="comment"># AR\I\MA的参数</span></span><br><span class="line">model1.summary() <span class="comment"># ARIMA(1,0,0)拟合结果 ARMA(1,0)</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/42.png" alt="42"></p>
<ul>
<li>自回归移动平均模型建模为ARIMA(1,0,0)，即ARMA(1,0)或者AR(1),收益率模型方程为</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mn>0.1419</mn><mo>+</mo><mn>0.1448</mn><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\large r_t=0.1419+0.1448 r_{t-1}+\varepsilon_t 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.873324em;vertical-align:-0.099996em;"></span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">.</span><span class="mord sizing reset-size6 size7">1</span><span class="mord sizing reset-size6 size7">4</span><span class="mord sizing reset-size6 size7">1</span><span class="mord sizing reset-size6 size7">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.019992em;vertical-align:-0.246664em;"></span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">.</span><span class="mord sizing reset-size6 size7">1</span><span class="mord sizing reset-size6 size7">4</span><span class="mord sizing reset-size6 size7">4</span><span class="mord sizing reset-size6 size7">8</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.6499999999999995em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20555333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同理，我们建立起其它阶数的模型</span></span><br><span class="line">model2 = arima.model.ARIMA(returns, order=(<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>)).fit()</span><br><span class="line">model2.summary() <span class="comment"># ARIMA(1,0,1)拟合结果 ARMA(1,1)</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/43.png" alt="43"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同理，我们建立起其它阶数的模型</span></span><br><span class="line">model2 = arima.model.ARIMA(returns, order=(<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>)).fit()</span><br><span class="line">model2.summary() <span class="comment"># ARIMA(1,0,1)拟合结果 ARMA(1,1)</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/44.png" alt="44"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对模型残差进行白噪声检验</span></span><br><span class="line">resid1 = model1.resid</span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">ax1 = plt.subplot(<span class="number">211</span>)</span><br><span class="line">ax1.plot(resid1)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;残差序列&#x27;</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line">fig = plot_acf(resid1, lags=<span class="number">12</span>, ax=ax3)</span><br><span class="line">ax3.set_xlabel(<span class="string">&#x27;残差序列的自相关系数图&#x27;</span>) </span><br><span class="line">LjungBox = stattools.q_stat(stattools.acf(resid1)[<span class="number">1</span>:<span class="number">12</span>], <span class="built_in">len</span>(resid1))</span><br><span class="line">np.<span class="built_in">round</span>(LjungBox[<span class="number">1</span>], <span class="number">2</span>) <span class="comment"># P值较大，残差序列可能为白噪声</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/45.png" alt="45"></p>
<h1 id="自回归条件异方差模型-autoregressive-conditional-heteroskedasticity-arch模型"><a class="markdownIt-Anchor" href="#自回归条件异方差模型-autoregressive-conditional-heteroskedasticity-arch模型"></a> 自回归条件异方差模型 - Autoregressive conditional heteroskedasticity, ARCH模型</h1>
<p>ARMA模型假设干扰项的方差为常数，然而很多情况下时间序列的波动有集聚性等特征。ARCH、GARCH模型可以刻画出随时间变化的条件异方差。</p>
<p>波动率不可直接观测，但是在一些资产收益率时间序列中却普遍存在以下情况：</p>
<ul>
<li>存在波动率聚集现象。 即波动率在一段时间上高，一段时间上低。</li>
<li>资产收益率并不满足正态分布–尖峰、厚尾、负偏</li>
<li>资产收益率<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{r_t\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>的扰动<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msub><mi>ε</mi><mi>t</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\varepsilon_t\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>是序列不相关的，但不是独立的；<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msubsup><mi>ε</mi><mi>t</mi><mn>2</mn></msubsup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\varepsilon_t^2\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>有自相关性</li>
</ul>
<p>ARCH、GARCH模型是波动率建模，对于期权定价、风险管理非常重要</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取上证指数日收益率数据</span></span><br><span class="line">SHret = pd.read_table(<span class="string">&#x27;TRD_IndexSum.txt&#x27;</span>, index_col=<span class="string">&#x27;Trddt&#x27;</span>, sep=<span class="string">&#x27;\t&#x27;</span>)</span><br><span class="line">SHret.index = pd.to_datetime(SHret.index)</span><br><span class="line">SHret = SHret.sort_index()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制收益率平方序列图</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">plt.subplot(<span class="number">211</span>)</span><br><span class="line">plt.plot(SHret**<span class="number">2</span>)</span><br><span class="line">plt.xticks([])</span><br><span class="line">plt.title(<span class="string">&#x27;Squared Daily Return of SH Index&#x27;</span>)</span><br><span class="line">plt.subplot(<span class="number">212</span>)</span><br><span class="line">plt.plot(SHret)</span><br><span class="line">plt.title(<span class="string">&#x27;Daily Return of SH Index&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/46.png" alt="46"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHret.mean()[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/47.png" alt="47"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br><span class="line">nsample=<span class="number">1200</span></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">6</span>),dpi=<span class="number">80</span>)</span><br><span class="line">rn=stats.norm.fit(SHret) </span><br><span class="line">n=stats.norm(loc=rn[<span class="number">0</span>],scale=rn[<span class="number">1</span>]) <span class="comment"># A normal continuous random variable</span></span><br><span class="line">n_rvs=np.linspace(n.ppf(<span class="number">.001</span>),n.ppf(<span class="number">.999</span>),nsample)  <span class="comment"># ppf: Percent point function (inverse of ``cdf`` --- percentiles)</span></span><br><span class="line">plt.plot(n_rvs,n.pdf(n_rvs),<span class="string">&#x27;r-&#x27;</span>,label=<span class="string">&#x27;normal&#x27;</span>)    <span class="comment"># pdf: Probability density function</span></span><br><span class="line">plt.hist(SHret,bins=<span class="number">60</span>,density=<span class="literal">True</span>,label=<span class="string">&#x27;sample&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;上证指数日收益率直方图&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">np.<span class="built_in">round</span>((SHret.mean()[<span class="number">0</span>], SHret.std()[<span class="number">0</span>],SHret.skew()[<span class="number">0</span>],SHret.kurt()[<span class="number">0</span>]),<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/48.png" alt="48"></p>
<h1 id="arch模型"><a class="markdownIt-Anchor" href="#arch模型"></a> ARCH模型</h1>
<p>假设资产收益率满足AR(1)模型，一个ARCH(m)模型（方差模型）假定：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>ϕ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>ϕ</mi><mn>1</mn></msub><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub><mspace linebreak="newline"></mspace><mstyle mathsize="1.2em"><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>α</mi><mn>1</mn></msub><msubsup><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>α</mi><mi>m</mi></msub><msubsup><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mi>m</mi></mrow><mn>2</mn></msubsup><mspace linebreak="newline"></mspace><mstyle mathsize="1.2em"><msub><mi>ε</mi><mi>t</mi></msub><mo>=</mo><msub><mi>σ</mi><mi>t</mi></msub><msub><mi>e</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>e</mi><mi>t</mi></msub><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex"> \large r_t=\phi_0+\phi_1 r_{t-1}+\varepsilon_t 
\\\large \sigma_t^2 = \alpha_0 + \alpha_1\varepsilon_{t-1}^2 + \cdots + \alpha_m \varepsilon_{t-m}^2 \\ 
\large \varepsilon_t = \sigma_t e_t,e_t\sim N(0,1) \\ </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0799919999999998em;vertical-align:-0.246664em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.6499999999999995em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20555333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline sizing reset-size6 size7"></span><span class="base"><span class="strut" style="height:1.3075519999999998em;vertical-align:-0.2964em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em;"><span style="top:-2.553em;margin-left:-0.03588em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.879996em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:-0.0037em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.3742159999999999em;vertical-align:-0.363064em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:-0.0037em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em;"><span style="top:-2.553em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.30255333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7999919999999999em;vertical-align:-0.099996em;"></span><span class="minner sizing reset-size6 size7">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.3742159999999999em;vertical-align:-0.363064em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.13704000000000002em;"><span style="top:-2.65em;margin-left:-0.0037em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em;"><span style="top:-2.553em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.30255333333333334em;"><span></span></span></span></span></span></span></span><span class="mspace newline sizing reset-size6 size7"></span><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.23332799999999998em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.03588em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em;"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.10903em;">N</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7">0</span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sizing reset-size6 size7">1</span><span class="mclose sizing reset-size6 size7">)</span></span><span class="mspace newline sizing reset-size6 size7"></span></span></span></span></p>
<ul>
<li>令<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">F_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>为截止<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69841em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>的信息， <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_t^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>为条件异方差: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>r</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>F</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>ε</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>F</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup><mi>V</mi><mi>a</mi><mi>r</mi><mo stretchy="false">(</mo><msub><mi>e</mi><mi>t</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>F</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><msub><mi>α</mi><mn>1</mn></msub><msubsup><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></msubsup><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>α</mi><mi>m</mi></msub><msubsup><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mi>m</mi></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">Var(r_t|F_{t-1})=Var(\varepsilon_t|F_{t-1})=\sigma_t^2 Var( e_t|F_{t-1})=\sigma_t^2= \alpha_0 + \alpha_1\varepsilon_{t-1}^2 + \cdots + \alpha_m \varepsilon_{t-m}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1205469999999997em;vertical-align:-0.30643899999999996em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999998em;"><span style="top:-2.451892em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.30643899999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1194389999999999em;vertical-align:-0.305331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305331em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>过去的扰动项<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mo stretchy="false">{</mo><msubsup><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mi>i</mi></mrow><mn>2</mn></msubsup><mo stretchy="false">}</mo></mrow><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup></mrow><annotation encoding="application/x-tex">{\{\varepsilon_{t-i}^2\}}^m_{i=1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2350949999999998em;vertical-align:-0.366695em;"></span><span class="mord"><span class="mord"><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.316995em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8684em;"><span style="top:-2.333305em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.267008em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.366695em;"><span></span></span></span></span></span></span></span></span></span>会影响方差项<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{\sigma_t^2\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>,也就是大的扰动会倾向于紧接着出现另一个大的扰动，这很好的刻画了波动率聚集现象。</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ε</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\varepsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为白噪音序列;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>ε</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\varepsilon_t^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>满足AR模型，利用偏自相关系数PACF判断阶m</li>
<li>模型的参数估计：收益率模型和方差模型（或者叫均值模型和波动率模型）进行联合估计，比如最大似然估计方法</li>
<li>模型参数估计后得到标准化残差<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>e</mi><mo>^</mo></mover><mi>t</mi></msub><mo>=</mo><msub><mover accent="true"><mi>ε</mi><mo>^</mo></mover><mi>t</mi></msub><mi mathvariant="normal">/</mi><msub><mover accent="true"><mi>σ</mi><mo>^</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\hat{e}_t=\hat{\varepsilon}_t/\hat{\sigma}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">e</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">ε</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，利用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mi>e</mi><mo>^</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\hat{e}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">e</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mover accent="true"><mi>e</mi><mo>^</mo></mover><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\hat{e}_t^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">e</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>的Ljung-Box检验(白噪声检验)来检验收益率模型和方差模型的正确性，如果通不过检验，需要同时调整收益率模型和方差模型重新建模</li>
</ul>
<h1 id="广义自回归条件异方差模型-garchmn"><a class="markdownIt-Anchor" href="#广义自回归条件异方差模型-garchmn"></a> 广义自回归条件异方差模型 - GARCH（m，n）</h1>
<p>GARCH（p，q）是应用于时间序列方差的ARMA模型，即它具有自回归项和移动平均项。<br>
假设资产收益率满足AR(1)模型，一个GARCH(m,n)模型（方差模型）假定：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><msub><mi>ϕ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>ϕ</mi><mn>1</mn></msub><msub><mi>r</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub><mspace linebreak="newline"></mspace><mstyle mathsize="1.2em"><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>α</mi><mi>i</mi></msub><msubsup><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mi>i</mi></mrow><mn>2</mn></msubsup><mo>+</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>β</mi><mi>j</mi></msub><msubsup><mi>σ</mi><mrow><mi>t</mi><mo>−</mo><mi>j</mi></mrow><mn>2</mn></msubsup><mspace linebreak="newline"></mspace><mstyle mathsize="1.2em"><msub><mi>ε</mi><mi>t</mi></msub><mo>=</mo><msub><mi>σ</mi><mi>t</mi></msub><msub><mi>e</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>e</mi><mi>t</mi></msub><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mstyle></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\large r_t=\phi_0+\phi_1 r_{t-1}+\varepsilon_t 
\\\large \sigma_t^2 = \alpha_0 + \sum_{i=1}^m\alpha_i\varepsilon_{t-i}^2+\sum_{j=1}^n\beta_j\sigma_{t-j}^2 \\ \large \varepsilon_t = \sigma_te_t,e_t\sim N(0,1) 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.066656em;vertical-align:-0.23332799999999998em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0799919999999998em;vertical-align:-0.246664em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.6499999999999995em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20555333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline sizing reset-size6 size7"></span><span class="base"><span class="strut" style="height:1.3075519999999998em;vertical-align:-0.2964em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em;"><span style="top:-2.553em;margin-left:-0.03588em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.879996em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.65em;margin-left:-0.0037em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.4712760000000005em;vertical-align:-1.5068219999999999em;"></span><span class="mop op-limits sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000005em;"><span style="top:-2.044315em;margin-left:0em;"><span class="pstrut" style="height:3.2em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2000050000000004em;"><span class="pstrut" style="height:3.2em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em;"><span class="pstrut" style="height:3.2em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.255685em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em;"><span style="top:-2.65em;margin-left:-0.0037em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666666em;"><span style="top:-2.553em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.2129999999999996em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.30255333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.6268280000000006em;vertical-align:-1.662374em;"></span><span class="mop op-limits sizing reset-size6 size7"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6370450000000003em;"><span style="top:-2.044315em;margin-left:0em;"><span class="pstrut" style="height:3.2em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2000050000000004em;"><span class="pstrut" style="height:3.2em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.450005000000001em;margin-left:0em;"><span class="pstrut" style="height:3.2em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3853116666666667em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.28968000000000005em;"><span style="top:-2.65em;margin-left:-0.05278em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8426266666666667em;"><span style="top:-2.553em;margin-left:-0.03588em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.213em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.37662666666666667em;"><span></span></span></span></span></span></span></span><span class="mspace newline sizing reset-size6 size7"></span><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.23332799999999998em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.03588em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em;"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.10903em;">N</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7">0</span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sizing reset-size6 size7">1</span><span class="mclose sizing reset-size6 size7">)</span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_t^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>为条件异方差。称<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>ε</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\varepsilon_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>服从GARCH(m,n)模型。经过变换，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>ε</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\varepsilon_t^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>类似ARMA模型: 令 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>η</mi><mi>t</mi></msub><mo>=</mo><msubsup><mi>ε</mi><mi>t</mi><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\eta_t=\varepsilon_t ^2-\sigma_t^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>, 则 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>η</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\eta_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为均值为0的不相关序列（白噪声？），且可得</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>ε</mi><mi>t</mi><mn>2</mn></msubsup><mo>=</mo><msub><mi>α</mi><mn>0</mn></msub><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></munderover><mo stretchy="false">(</mo><msub><mi>α</mi><mi>i</mi></msub><mo>+</mo><msub><mi>β</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msubsup><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mi>i</mi></mrow><mn>2</mn></msubsup><mo>+</mo><msub><mi>η</mi><mi>t</mi></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>β</mi><mi>j</mi></msub><msub><mi>η</mi><mrow><mi>t</mi><mo>−</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">    \varepsilon_{t}^2=\alpha_0+\sum_{i=1}^{\max(m,n)}(\alpha_i+\beta_i)\varepsilon_{t-i}^2+\eta_t-\sum_{j=1}^n \beta_j\eta_{t-j}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.2386740000000005em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.9610050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.386005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight">max</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1694390000000001em;vertical-align:-0.305331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">i</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设收益率模型中 phi_1=0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上证指数日收益率序列的白噪声检验</span></span><br><span class="line">LjungBox1 = stattools.q_stat(stattools.acf(SHret)[<span class="number">1</span>:<span class="number">13</span>], <span class="built_in">len</span>(SHret))</span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">round</span>(LjungBox1[<span class="number">1</span>],<span class="number">2</span>)) <span class="comment"># Q统计量的P value</span></span><br><span class="line"><span class="comment"># 不能拒绝白噪声假设</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上证指数日收益率序列平方的白噪声检验</span></span><br><span class="line">LjungBox = stattools.q_stat(stattools.acf(SHret**<span class="number">2</span>)[<span class="number">1</span>:<span class="number">13</span>], <span class="built_in">len</span>(SHret))</span><br><span class="line">LjungBox[<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 拒绝平方序列白噪声假设，有ARCH效应，下一步进行GARCH建模</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/49.png" alt="49"><br>
<img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/50.png" alt="50"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> arch <span class="keyword">import</span> arch_model</span><br><span class="line">am = arch_model(SHret) <span class="comment"># arch_model 默认建立GARCH(1,1)模型</span></span><br><span class="line">GARCHmodel = am.fit(update_freq=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(GARCHmodel.summary())</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/51.png" alt="51"></p>
<ul>
<li>GARCH建模结果为
<ul>
<li>收益率模型<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mn>3.3359</mn><mi>e</mi><mo>−</mo><mn>04</mn><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\large r_t=3.3359e-04+\varepsilon_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.02778em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.873324em;vertical-align:-0.099996em;"></span><span class="mord sizing reset-size6 size7">3</span><span class="mord sizing reset-size6 size7">.</span><span class="mord sizing reset-size6 size7">3</span><span class="mord sizing reset-size6 size7">3</span><span class="mord sizing reset-size6 size7">5</span><span class="mord sizing reset-size6 size7">9</span><span class="mord mathdefault sizing reset-size6 size7">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.873324em;vertical-align:-0.099996em;"></span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>波动率模型<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>ε</mi><mi>t</mi></msub><mo>=</mo><msub><mi>σ</mi><mi>t</mi></msub><msub><mi>e</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>e</mi><mi>t</mi></msub><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mstyle mathsize="1.2em"><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup><mo>=</mo><mn>3.7169</mn><mi>e</mi><mo>−</mo><mn>06</mn><mo>+</mo><mn>0.05</mn><msubsup><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></msubsup><mo>+</mo><mn>0.93</mn><msubsup><mi>σ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></msubsup></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\large \varepsilon_t = \sigma_t e_t,e_t\sim N(0,1) \\ 
\large \sigma_t^2 = 3.7169e-06 + 0.05 \varepsilon_{t-1}^2+ 0.93\sigma_{t-1}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.23332799999999998em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.03588em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">∼</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.3em;"></span><span class="mord mathdefault sizing reset-size6 size7" style="margin-right:0.10903em;">N</span><span class="mopen sizing reset-size6 size7">(</span><span class="mord sizing reset-size6 size7">0</span><span class="mpunct sizing reset-size6 size7">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sizing reset-size6 size7">1</span><span class="mclose sizing reset-size6 size7">)</span></span><span class="mspace newline sizing reset-size6 size7"></span><span class="base"><span class="strut" style="height:1.247552em;vertical-align:-0.2964em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7926266666666667em;"><span style="top:-2.553em;margin-left:-0.03588em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.163em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.873324em;vertical-align:-0.099996em;"></span><span class="mord sizing reset-size6 size7">3</span><span class="mord sizing reset-size6 size7">.</span><span class="mord sizing reset-size6 size7">7</span><span class="mord sizing reset-size6 size7">1</span><span class="mord sizing reset-size6 size7">6</span><span class="mord sizing reset-size6 size7">9</span><span class="mord mathdefault sizing reset-size6 size7">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.873324em;vertical-align:-0.099996em;"></span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.314216em;vertical-align:-0.363064em;"></span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">.</span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">5</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7926266666666667em;"><span style="top:-2.553em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.163em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.30255333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.314216em;vertical-align:-0.363064em;"></span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">.</span><span class="mord sizing reset-size6 size7">9</span><span class="mord sizing reset-size6 size7">3</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7926266666666667em;"><span style="top:-2.553em;margin-left:-0.03588em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.163em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.30255333333333334em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dfG = pd.concat([SHret,GARCHmodel.resid,GARCHmodel.std_resid,GARCHmodel.conditional_volatility],axis=<span class="number">1</span>)</span><br><span class="line">dfG</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/52.png" alt="52"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">std_resid = dfG.std_resid <span class="comment"># 标准化残差</span></span><br><span class="line"><span class="comment"># 绘制标准化残差及其平方序列图</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">plt.subplot(<span class="number">211</span>)</span><br><span class="line">plt.plot(std_resid**<span class="number">2</span>)</span><br><span class="line">plt.xticks([])</span><br><span class="line">plt.title(<span class="string">&#x27;Squared Standardized Residual&#x27;</span>)</span><br><span class="line">plt.subplot(<span class="number">212</span>)</span><br><span class="line">plt.plot(std_resid)</span><br><span class="line">plt.title(<span class="string">&#x27;Standardized Residual&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/53.png" alt="53"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对标准化残差进行白噪声检验</span></span><br><span class="line">std_resid = dfG.std_resid</span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>, <span class="number">10</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">ax1 = plt.subplot(<span class="number">211</span>)</span><br><span class="line">ax1.plot(std_resid)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;残差序列&#x27;</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line">fig = plot_acf(std_resid, lags=<span class="number">12</span>, ax=ax3)</span><br><span class="line">ax3.set_xlabel(<span class="string">&#x27;残差序列的自相关系数图&#x27;</span>) </span><br><span class="line">LjungBox = stattools.q_stat(stattools.acf(std_resid)[<span class="number">1</span>:<span class="number">12</span>], <span class="built_in">len</span>(std_resid))</span><br><span class="line">np.<span class="built_in">round</span>(LjungBox[<span class="number">1</span>],<span class="number">2</span>) <span class="comment"># P值较大，标准化残差序列可能为白噪声</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/54.png" alt="54"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对标准化残差的平方进行白噪声检验</span></span><br><span class="line">std_resid2 = std_resid**<span class="number">2</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>, <span class="number">10</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">ax1 = plt.subplot(<span class="number">211</span>)</span><br><span class="line">ax1.plot(std_resid2)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;残差序列&#x27;</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line">fig = plot_acf(std_resid2, lags=<span class="number">12</span>, ax=ax3)</span><br><span class="line">ax3.set_xlabel(<span class="string">&#x27;残差序列的自相关系数图&#x27;</span>) </span><br><span class="line">LjungBox = stattools.q_stat(stattools.acf(std_resid2)[<span class="number">1</span>:<span class="number">12</span>], <span class="built_in">len</span>(std_resid2))</span><br><span class="line">np.<span class="built_in">round</span>(LjungBox[<span class="number">1</span>],<span class="number">2</span>) <span class="comment"># P值较大，残差序列可能为白噪声</span></span><br><span class="line"><span class="comment"># stattools.acf(std_resid2,nlags=30,alpha=0.05,qstat=True,missing=&#x27;drop&#x27;)</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/55.png" alt="55"></p>
<h1 id="基于价差序列的时间序列建模模拟协整配对交易策列的收益与风险"><a class="markdownIt-Anchor" href="#基于价差序列的时间序列建模模拟协整配对交易策列的收益与风险"></a> 基于价差序列的时间序列建模模拟协整配对交易策列的收益与风险</h1>
<ul>
<li>第一步：价差序列的时间序列建模</li>
<li>第二部：模拟未来价格序列以及计算相应的收益与风险</li>
</ul>
<h2 id="第一步价差序列的时间序列建模"><a class="markdownIt-Anchor" href="#第一步价差序列的时间序列建模"></a> 第一步：价差序列的时间序列建模</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 形成期浦发银行股票对数价格对中国银行股票对数价格回归分析残差 </span></span><br><span class="line"><span class="built_in">print</span>(spreadf.describe())</span><br><span class="line">spreadf  <span class="comment"># 残差</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/56.png" alt="56"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对残差项进行平稳性检验进行平稳性检验(ADF检验是否存在单位根)</span></span><br><span class="line">spreadf.plot()</span><br><span class="line">plt.title(<span class="string">&#x27;价差序列&#x27;</span>) </span><br><span class="line"></span><br><span class="line">adfSpread = ADF(spreadf, trend=<span class="string">&#x27;c&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(adfSpread.summary().as_text())</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/57.png" alt="57"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对残差进行白噪声检验 </span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>, <span class="number">10</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">ax1 = plt.subplot(<span class="number">211</span>)</span><br><span class="line">ax1.plot(spreadf)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;残差序列&#x27;</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line">fig = plot_acf(spreadf, lags=<span class="number">12</span>, ax=ax3)</span><br><span class="line">ax3.set_xlabel(<span class="string">&#x27;残差序列的自相关系数图&#x27;</span>) </span><br><span class="line">LjungBox=stattools.q_stat(stattools.acf(spreadf)[<span class="number">1</span>:<span class="number">12</span>], <span class="built_in">len</span>(spreadf))</span><br><span class="line">np.<span class="built_in">round</span>(LjungBox[<span class="number">1</span>],<span class="number">2</span>) <span class="comment"># P值几乎为0，残差序列不是白噪声，存在自相关性</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/58.png" alt="58"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过BIC准则选择ARMA(p,q)模型的阶数</span></span><br><span class="line">order_select1 = stattools.arma_order_select_ic(spreadf, max_ma=<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/59.png" alt="59"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(order_select1[<span class="string">&#x27;bic_min_order&#x27;</span>]) <span class="comment"># 输出最小BIC的(p, q)对</span></span><br><span class="line">order_select1[<span class="string">&#x27;bic&#x27;</span>]  <span class="comment"># 各(p, q)对 对应的BIC值</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/60.png" alt="60"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> statsmodels.tsa <span class="keyword">import</span> arima</span><br><span class="line"><span class="comment"># order表示建立的模型的阶数，c(1,0,0)表示建立的是ARMA(1,0)模型；</span></span><br><span class="line"><span class="comment"># 中间的数字0表示使用原始的、未进行过差分（差分次数为0）的数据；</span></span><br><span class="line"><span class="comment"># 此处我们无需考虑它</span></span><br><span class="line">model3 = arima.model.ARIMA(spreadf, order=(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>)).fit()</span><br><span class="line">model3.summary()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/61.png" alt="61"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对模型残差进行白噪声检验</span></span><br><span class="line">resid3 = model3.resid</span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">ax1 = plt.subplot(<span class="number">211</span>)</span><br><span class="line">ax1.plot(resid3)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;残差序列&#x27;</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line">fig = plot_acf(resid3, lags=<span class="number">12</span>, ax=ax3)</span><br><span class="line">ax3.set_xlabel(<span class="string">&#x27;残差序列的自相关系数图&#x27;</span>) </span><br><span class="line">LjungBox=stattools.q_stat(stattools.acf(resid3)[<span class="number">1</span>:<span class="number">12</span>], <span class="built_in">len</span>(resid3))</span><br><span class="line">np.<span class="built_in">round</span>(LjungBox[<span class="number">1</span>], <span class="number">2</span>) <span class="comment"># P值较大，残差序列可能为白噪声</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/62.png" alt="62"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对模型残差平方进行白噪声检验</span></span><br><span class="line">resid3_2 = resid3**<span class="number">2</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>), dpi=<span class="number">80</span>)  </span><br><span class="line">ax1 = plt.subplot(<span class="number">211</span>)</span><br><span class="line">ax1.plot(resid3_2)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;残差平方序列&#x27;</span>)</span><br><span class="line">ax3 = fig.add_subplot(<span class="number">212</span>)</span><br><span class="line">fig = plot_acf(resid3_2,lags=<span class="number">12</span>,ax=ax3)</span><br><span class="line">ax3.set_xlabel(<span class="string">&#x27;残差平方序列的自相关系数图&#x27;</span>) </span><br><span class="line">LjungBox = stattools.q_stat(stattools.acf(resid3_2)[<span class="number">1</span>:<span class="number">12</span>], <span class="built_in">len</span>(resid3_2))</span><br><span class="line">np.<span class="built_in">round</span>(LjungBox[<span class="number">1</span>], <span class="number">2</span>) <span class="comment"># P值较大，残差平方序列可能为白噪声</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/63.png" alt="63"></p>
<ul>
<li>没有ARCH效应，对价差序列<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>建立自回归移动平均模型：建模为ARIMA(1,0,0)，即ARMA(1,0)或者AR(1), 模型方程为</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathsize="1.2em"><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mo>−</mo><mn>0.0001</mn><mo>+</mo><mn>0.9193</mn><msub><mi>S</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\large S_t=-0.0001+0.9193 S_{t-1}+\varepsilon_t 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9999959999999999em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:-0.05764em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size7">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.873324em;vertical-align:-0.099996em;"></span><span class="mord sizing reset-size6 size7">−</span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">.</span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.06666em;vertical-align:-0.246664em;"></span><span class="mord sizing reset-size6 size7">0</span><span class="mord sizing reset-size6 size7">.</span><span class="mord sizing reset-size6 size7">9</span><span class="mord sizing reset-size6 size7">1</span><span class="mord sizing reset-size6 size7">9</span><span class="mord sizing reset-size6 size7">3</span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2796266666666667em;"><span style="top:-2.6499999999999995em;margin-left:-0.05764em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.20555333333333334em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size7">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.696672em;vertical-align:-0.18em;"></span><span class="mord sizing reset-size6 size7"><span class="mord mathdefault">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.26005333333333336em;"><span style="top:-2.65em;margin-left:0em;margin-right:0.04166666666666667em;"><span class="pstrut" style="height:2.8em;"></span><span class="sizing reset-size7 size4 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br><span class="line">nsample = <span class="number">1200</span></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">6</span>), dpi=<span class="number">80</span>)</span><br><span class="line">rn = stats.norm.fit(resid3) </span><br><span class="line">n = stats.norm(loc=rn[<span class="number">0</span>], scale=rn[<span class="number">1</span>]) <span class="comment"># A normal continuous random variable</span></span><br><span class="line">n_rvs = np.linspace(n.ppf(<span class="number">.001</span>), n.ppf(<span class="number">.999</span>), nsample)  <span class="comment"># ppf: Percent point function (inverse of ``cdf`` --- percentiles)</span></span><br><span class="line">plt.plot(n_rvs, n.pdf(n_rvs), <span class="string">&#x27;r-&#x27;</span>, label=<span class="string">&#x27;normal&#x27;</span>)    <span class="comment"># pdf: Probability density function</span></span><br><span class="line">plt.hist(resid3, bins=<span class="number">60</span>, density=<span class="literal">True</span>, label=<span class="string">&#x27;sample&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;残差序列直方图&#x27;</span>) <span class="comment"># 残差不是正态分布</span></span><br><span class="line">plt.legend()</span><br><span class="line"><span class="built_in">print</span>(np.<span class="built_in">round</span>((resid3.mean(), resid3.std(), resid3.skew(), resid3.kurt()),<span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/64.png" alt="64"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(resid3.describe())</span><br><span class="line">resid3</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/65.png" alt="65"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> statsmodels.api <span class="keyword">as</span> sm</span><br><span class="line"></span><br><span class="line"><span class="comment">#r_t 对 r_&#123;t-1&#125; 回归分析  </span></span><br><span class="line">model4 = sm.OLS(spreadf,sm.add_constant(spreadf.shift()), missing=<span class="string">&#x27;drop&#x27;</span>)</span><br><span class="line">results4 = model4.fit()</span><br><span class="line"><span class="built_in">print</span>(results4.summary())</span><br><span class="line"></span><br><span class="line">alpha4 = results4.params[<span class="number">0</span>]  <span class="comment"># 常数估计\hat&#123;alpha&#125;</span></span><br><span class="line">beta4 = results4.params[<span class="number">1</span>]   <span class="comment"># 自变量系数估计 \hat&#123;beta&#125;</span></span><br><span class="line">resid4 = spreadf-beta4*spreadf.shift()-alpha4  <span class="comment"># 残差</span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/66.png" alt="66"></p>
<h2 id="第二步模型交易期配对价格序列并计算协整配对交易的收益与风险"><a class="markdownIt-Anchor" href="#第二步模型交易期配对价格序列并计算协整配对交易的收益与风险"></a> 第二步：模型交易期配对价格序列，并计算协整配对交易的收益与风险</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">TradeSpreadSimulation</span>(<span class="params">spreadf, model3, CoSpreadT</span>):  <span class="comment">## 第二步：模型交易期配对价格序列，并计算协整配对交易的收益与风险</span></span><br><span class="line">    SimSpreadT = pd.Series(np.zeros(<span class="built_in">len</span>(CoSpreadT)), index=CoSpreadT.index)  <span class="comment"># len(CoSpreadT) 交易期天数</span></span><br><span class="line">    resid3 = model3.resid</span><br><span class="line">    alpha = model3.params[<span class="number">0</span>]  <span class="comment"># 常数估计\hat&#123;alpha&#125;</span></span><br><span class="line">    beta = model3.params[<span class="number">1</span>]   <span class="comment"># 自变量系数估计 \hat&#123;beta&#125;</span></span><br><span class="line">    s0 = spreadf[-<span class="number">1</span>]  <span class="comment"># 形成期最后一天的价差作为交易期的起点</span></span><br><span class="line">    uniformInt = <span class="built_in">list</span>(np.random.randint(<span class="number">0</span>, <span class="built_in">len</span>(resid3), size=<span class="built_in">len</span>(CoSpreadT)))</span><br><span class="line">    rdresid=<span class="built_in">list</span>(resid3.iloc[uniformInt])  <span class="comment"># 从形成期残差中随机抽样作为交易期残差</span></span><br><span class="line"><span class="comment">#     rdresid=list(np.random.randn(len(CoSpreadT))*resid3.std()+resid3.mean())  #也可以假设残差服从正态分布  </span></span><br><span class="line">    SimSpreadT.iloc[<span class="number">0</span>]=alpha+beta*s0+rdresid[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(CoSpreadT)):</span><br><span class="line">        SimSpreadT.iloc[i]=alpha+beta*SimSpreadT.iloc[i-<span class="number">1</span>]+rdresid[i]</span><br><span class="line">    <span class="keyword">return</span> SimSpreadT </span><br><span class="line">SimSpreadT = TradeSpreadSimulation(spreadf, model3, CoSpreadT)</span><br><span class="line">SimSpreadT.plot(figsize=(<span class="number">15</span>, <span class="number">6</span>))</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/67.png" alt="67"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>) </span><br><span class="line">SimSpreadT.plot(label=<span class="string">&#x27;模拟价差序列&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;模拟交易期中国银行与浦发银行价差序列(协整配对)&#x27;</span>) </span><br><span class="line">plt.axhline(y=mean_co,color=<span class="string">&#x27;black&#x27;</span>,label=<span class="string">&#x27;均值&#x27;</span>)  </span><br><span class="line">plt.axhline(y=thresholdUpOpen_co,color=<span class="string">&#x27;green&#x27;</span>,label=<span class="string">&#x27;开仓线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownOpen_co,color=<span class="string">&#x27;green&#x27;</span>) </span><br><span class="line">plt.axhline(y=thresholdUpClose_co,color=<span class="string">&#x27;red&#x27;</span>,label=<span class="string">&#x27;平仓线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownClose_co,color=<span class="string">&#x27;red&#x27;</span>) </span><br><span class="line">plt.axhline(y=thresholdUpStopLoss_co,color=<span class="string">&#x27;blue&#x27;</span>,label=<span class="string">&#x27;止损线&#x27;</span>)</span><br><span class="line">plt.axhline(y=thresholdDownStopLoss_co,color=<span class="string">&#x27;blue&#x27;</span>) </span><br><span class="line">plt.legend()</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/68.png" alt="68"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SimSignal=TradeSig1(SimSpreadT) </span><br><span class="line">SimPosition=TradePosition(SimSignal)</span><br><span class="line">fig=plt.figure(figsize=(<span class="number">20</span>,<span class="number">8</span>),dpi=<span class="number">80</span>)  </span><br><span class="line">ax1=plt.subplot(<span class="number">211</span>)</span><br><span class="line">ax1.plot(SimSignal)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;Simulated Trade Signal&#x27;</span>)</span><br><span class="line">ax3=fig.add_subplot(<span class="number">212</span>)</span><br><span class="line">ax3.plot(SimPosition)</span><br><span class="line">ax3.set_xlabel(<span class="string">&#x27;Simulated Position&#x27;</span>) </span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/69.png" alt="69"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义模拟交易账户函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SimTradeCo</span>(<span class="params">SimSpreadT,SimPosition</span>):</span><br><span class="line">    n=<span class="built_in">len</span>(SimPosition)</span><br><span class="line">    moneysize=<span class="number">10000</span> <span class="comment"># 模拟10000次</span></span><br><span class="line">    valueY=moneysize*SimPosition <span class="comment"># 开仓投资到Y的资金</span></span><br><span class="line">    valueX=[(-beta)*valueY[<span class="number">0</span>]] <span class="comment"># 双边建仓     # -beta=moneyX/moneyY</span></span><br><span class="line">    opencashunbalance=-(valueX[<span class="number">0</span>]+valueY[<span class="number">0</span>])   </span><br><span class="line">    openspread=SimSpreadT[<span class="number">0</span>]</span><br><span class="line">    cash=[<span class="number">10000</span>+opencashunbalance]  </span><br><span class="line">    asset=[cash[<span class="number">0</span>]]</span><br><span class="line">    closecashunbalance=<span class="number">0</span></span><br><span class="line">    closespread=<span class="number">0</span></span><br><span class="line">    TradeDate=[]</span><br><span class="line">    tradeNum=<span class="number">0</span></span><br><span class="line">    winNum=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">        valueX.append(valueX[i-<span class="number">1</span>]) <span class="comment"># 如果下面的判断语句都为否，则开仓资金与上一时间相同</span></span><br><span class="line">        cash.append(cash[i-<span class="number">1</span>])     <span class="comment"># 如果没有新的开仓平仓操作，则现金与上一时间相同</span></span><br><span class="line">        asset.append(asset[i-<span class="number">1</span>])     <span class="comment"># 如果没有新的平仓操作，假设总资产与上一时间相同（没有mark to market，平仓时更新股票收益）</span></span><br><span class="line">        <span class="keyword">if</span> SimPosition[i-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> SimPosition[i]==<span class="number">1</span>: <span class="comment">#新开仓</span></span><br><span class="line">            valueX[i]=(-beta)*valueY[i] </span><br><span class="line">            opencashunbalance=-(valueY[i]+valueX[i])</span><br><span class="line">            openspread=SimSpreadT[i]</span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+opencashunbalance</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：买入 %.2f 元浦发银行股票，同时卖空 %.2f 元中国银行股票，现金账户增加 %.2f 元  &#x27;</span>\</span><br><span class="line">                  % (SimSpreadT.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),valueY[i],-valueX[i],opencashunbalance))</span><br><span class="line">        <span class="keyword">elif</span> SimPosition[i-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> SimPosition[i]==-<span class="number">1</span>:</span><br><span class="line">            valueX[i]=(-beta)*valueY[i] </span><br><span class="line">            opencashunbalance=-(valueY[i]+valueX[i])</span><br><span class="line">            openspread=SimSpreadT[i]</span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+opencashunbalance</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：卖空 %.2f 元浦发银行股票，同时买入 %.2f元中国银行股票，现金账户增加 %.2f 元 &#x27;</span>\</span><br><span class="line">                  % (SimSpreadT.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),-valueY[i],valueX[i],opencashunbalance))</span><br><span class="line">        <span class="keyword">elif</span> SimPosition[i-<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> SimPosition[i]==<span class="number">0</span>:</span><br><span class="line">            valueX[i]=<span class="number">0</span></span><br><span class="line">            closespread=SimSpreadT[i]</span><br><span class="line">            profit=valueY[i-<span class="number">1</span>]*(closespread-openspread)</span><br><span class="line">            tradeNum=tradeNum+<span class="number">1</span> <span class="comment">#平仓一次完成一次开平仓操作</span></span><br><span class="line">            <span class="keyword">if</span> profit&gt;<span class="number">0</span>:</span><br><span class="line">                winNum=winNum+<span class="number">1</span> <span class="comment"># 完成一次盈利开平仓操作</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]-opencashunbalance+profit</span><br><span class="line">            asset[i]=cash[i] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;</span>\</span><br><span class="line">                  % (SimSpreadT.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),profit,cash[i]))</span><br><span class="line">        <span class="keyword">elif</span> SimPosition[i-<span class="number">1</span>]==-<span class="number">1</span> <span class="keyword">and</span> SimPosition[i]==<span class="number">0</span>:</span><br><span class="line">            valueX[i]=<span class="number">0</span></span><br><span class="line">            closespread=SimSpreadT[i]</span><br><span class="line">            profit=valueY[i-<span class="number">1</span>]*(closespread-openspread)</span><br><span class="line">            tradeNum=tradeNum+<span class="number">1</span> <span class="comment">#平仓一次完成一次开平仓操作</span></span><br><span class="line">            <span class="keyword">if</span> profit&gt;<span class="number">0</span>:</span><br><span class="line">                winNum=winNum+<span class="number">1</span> <span class="comment"># 完成一次盈利开平仓操作</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]-opencashunbalance+profit</span><br><span class="line">            asset[i]=cash[i] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;</span>\</span><br><span class="line">                  % (SimSpreadT.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),profit,cash[i]))</span><br><span class="line">        <span class="keyword">elif</span> SimPosition[i-<span class="number">1</span>]==-<span class="number">1</span> <span class="keyword">and</span> SimPosition[i]==<span class="number">1</span>:</span><br><span class="line">            <span class="comment"># 先平仓 position: -1--&gt;0</span></span><br><span class="line">            closespread=SimSpreadT[i]</span><br><span class="line">            profit=valueY[i-<span class="number">1</span>]*(closespread-openspread)</span><br><span class="line">            tradeNum=tradeNum+<span class="number">1</span> <span class="comment">#平仓一次完成一次开平仓操作</span></span><br><span class="line">            <span class="keyword">if</span> profit&gt;<span class="number">0</span>:</span><br><span class="line">                winNum=winNum+<span class="number">1</span> <span class="comment"># 完成一次盈利开平仓操作</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]-opencashunbalance+profit</span><br><span class="line">            asset[i]=cash[i] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;</span>\</span><br><span class="line">                  % (SimSpreadT.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),profit,cash[i]))</span><br><span class="line">            <span class="comment"># 再反向开仓 position: 0--&gt;1</span></span><br><span class="line">            valueX[i]=(-beta)*valueY[i] </span><br><span class="line">            opencashunbalance=-(valueY[i]+valueX[i])</span><br><span class="line">            openspread=SimSpreadT[i]</span><br><span class="line">            cash[i]=cash[i]+opencashunbalance</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：买入 %.2f 元浦发银行股票，同时卖空 %.2f 元中国银行股票，现金账户增加 %.2f 元  &#x27;</span>\</span><br><span class="line">                  % (SimSpreadT.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),valueY[i],-valueX[i],opencashunbalance))</span><br><span class="line">        <span class="keyword">elif</span> SimPosition[i-<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> SimPosition[i]==-<span class="number">1</span>:</span><br><span class="line">            <span class="comment"># 先平仓 position: 1--&gt;0</span></span><br><span class="line">            closespread=SimSpreadT[i]</span><br><span class="line">            profit=valueY[i-<span class="number">1</span>]*(closespread-openspread)</span><br><span class="line">            tradeNum=tradeNum+<span class="number">1</span> <span class="comment">#平仓一次完成一次开平仓操作</span></span><br><span class="line">            <span class="keyword">if</span> profit&gt;<span class="number">0</span>:</span><br><span class="line">                winNum=winNum+<span class="number">1</span> <span class="comment"># 完成一次盈利开平仓操作</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]-opencashunbalance+profit</span><br><span class="line">            asset[i]=cash[i] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;</span>\</span><br><span class="line">                  % (SimSpreadT.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),profit,cash[i]))</span><br><span class="line">            <span class="comment"># 再反向开仓 position: 0--&gt;-1</span></span><br><span class="line">            valueX[i]=(-beta)*valueY[i] </span><br><span class="line">            opencashunbalance=-(valueY[i]+valueX[i])</span><br><span class="line">            openspread=SimSpreadT[i]</span><br><span class="line">            cash[i]=cash[i]+opencashunbalance</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s 开仓：卖空 %.2f 元浦发银行股票，同时买入 %.2f元中国银行股票，现金账户增加 %.2f 元 &#x27;</span>\</span><br><span class="line">                  % (SimSpreadT.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),-valueY[i],valueX[i],opencashunbalance))</span><br><span class="line">    <span class="keyword">if</span> valueY[-<span class="number">1</span>]!=<span class="number">0</span>:<span class="comment"># 最后交易日仍有仓位，平仓</span></span><br><span class="line">        <span class="keyword">if</span> valueY[-<span class="number">2</span>]==<span class="number">0</span> :<span class="comment"># 最后交易日开仓，直接平仓（相当于最后交易日无操作）</span></span><br><span class="line">            closespread=SimSpreadT[-<span class="number">1</span>]</span><br><span class="line">            profit=<span class="number">0</span> <span class="comment"># 最后一日开仓又平仓不计入开平仓操作</span></span><br><span class="line">            cash[-<span class="number">1</span>]=cash[-<span class="number">1</span>]-opencashunbalance+profit</span><br><span class="line">            asset[-<span class="number">1</span>]=cash[-<span class="number">1</span>] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            valueY[-<span class="number">1</span>]=<span class="number">0</span> <span class="comment">#归0</span></span><br><span class="line">            valueX[-<span class="number">1</span>]=<span class="number">0</span> <span class="comment">#归0</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[-<span class="number">2</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[-<span class="number">1</span>])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;最后交易日 %s 开仓又平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;</span>\</span><br><span class="line">                      % (SimSpreadT.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),profit,cash[i]))</span><br><span class="line">        <span class="keyword">else</span>:         </span><br><span class="line">            closespread=SimSpreadT[-<span class="number">1</span>]</span><br><span class="line">            profit=valueY[-<span class="number">2</span>]*(closespread-openspread)</span><br><span class="line">            tradeNum=tradeNum+<span class="number">1</span> <span class="comment">#平仓一次完成一次开平仓操作</span></span><br><span class="line">            <span class="keyword">if</span> profit&gt;<span class="number">0</span>:</span><br><span class="line">                winNum=winNum+<span class="number">1</span> <span class="comment"># 完成一次盈利开平仓操作</span></span><br><span class="line">            cash[-<span class="number">1</span>]=cash[-<span class="number">2</span>]-opencashunbalance+profit</span><br><span class="line">            asset[-<span class="number">1</span>]=cash[-<span class="number">1</span>] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[-<span class="number">2</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[-<span class="number">1</span>])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;最后交易日 %s 平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;</span>\</span><br><span class="line">                      % (SimSpreadT.index[i].strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>),profit,cash[i]))</span><br><span class="line">        </span><br><span class="line">    cash = pd.Series(cash,index=SimPosition.index)</span><br><span class="line">    valueY=pd.Series(valueY,index=SimPosition.index)</span><br><span class="line">    valueX=pd.Series(valueX,index=SimPosition.index) </span><br><span class="line">    asset = pd.Series(asset,index=SimPosition.index)</span><br><span class="line">    account=pd.DataFrame(&#123;<span class="string">&#x27;Position&#x27;</span>:SimPosition,<span class="string">&#x27;ValueY&#x27;</span>:valueY,<span class="string">&#x27;ValueX&#x27;</span>:valueX,<span class="string">&#x27;Cash&#x27;</span>:cash,<span class="string">&#x27;Asset&#x27;</span>:asset,&#125;)</span><br><span class="line">    TradeDates=[] <span class="comment"># 删除列表TradeDate中重复的日期</span></span><br><span class="line">    <span class="keyword">for</span> date <span class="keyword">in</span> TradeDate:</span><br><span class="line">        <span class="keyword">if</span> date <span class="keyword">not</span> <span class="keyword">in</span> TradeDates:</span><br><span class="line">            TradeDates.append(date)</span><br><span class="line">    <span class="keyword">return</span>(account,TradeDates,tradeNum,winNum)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试模拟交易</span></span><br><span class="line">account, TradeDates, tradeNum, winNum = SimTradeCo(SimSpreadT, SimPosition)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n完成 %s 次开平仓操作，其中成功 %s 次，成功率 %.0f%%&#x27;</span>%(tradeNum, winNum, winNum/tradeNum*<span class="number">100</span>))</span><br><span class="line">account.loc[TradeDates]</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/70.png" alt="70"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义模拟交易账户函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SimTradeCo2</span>(<span class="params">SimSpreadT,SimPosition</span>):</span><br><span class="line">    n=<span class="built_in">len</span>(SimPosition)</span><br><span class="line">    moneysize=<span class="number">10000</span></span><br><span class="line">    valueY=moneysize*SimPosition <span class="comment"># 开仓投资到Y的资金</span></span><br><span class="line">    valueX=[(-beta)*valueY[<span class="number">0</span>]] <span class="comment"># 双边建仓     # -beta=moneyX/moneyY</span></span><br><span class="line">    opencashunbalance=-(valueX[<span class="number">0</span>]+valueY[<span class="number">0</span>])   </span><br><span class="line">    openspread=SimSpreadT[<span class="number">0</span>]</span><br><span class="line">    cash=[<span class="number">10000</span>+opencashunbalance]  </span><br><span class="line">    asset=[cash[<span class="number">0</span>]]</span><br><span class="line">    closecashunbalance=<span class="number">0</span></span><br><span class="line">    closespread=<span class="number">0</span></span><br><span class="line">    TradeDate=[]</span><br><span class="line">    tradeNum=<span class="number">0</span></span><br><span class="line">    winNum=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">        valueX.append(valueX[i-<span class="number">1</span>]) <span class="comment"># 如果下面的判断语句都为否，则开仓资金与上一时间相同</span></span><br><span class="line">        cash.append(cash[i-<span class="number">1</span>])     <span class="comment"># 如果没有新的开仓平仓操作，则现金与上一时间相同</span></span><br><span class="line">        asset.append(asset[i-<span class="number">1</span>])     <span class="comment"># 如果没有新的平仓操作，假设总资产与上一时间相同（没有mark to market，平仓时更新股票收益）</span></span><br><span class="line">        <span class="keyword">if</span> SimPosition[i-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> SimPosition[i]==<span class="number">1</span>: <span class="comment">#新开仓</span></span><br><span class="line">            valueX[i]=(-beta)*valueY[i] </span><br><span class="line">            opencashunbalance=-(valueY[i]+valueX[i])</span><br><span class="line">            openspread=SimSpreadT[i]</span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+opencashunbalance</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line"><span class="comment">#             print(&#x27;%s 开仓：买入 %.2f 元浦发银行股票，同时卖空 %.2f 元中国银行股票，现金账户增加 %.2f 元  &#x27;\</span></span><br><span class="line"><span class="comment">#                   % (SimSpreadT.index[i].strftime(&#x27;%Y-%m-%d&#x27;),valueY[i],-valueX[i],opencashunbalance))</span></span><br><span class="line">        <span class="keyword">elif</span> SimPosition[i-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> SimPosition[i]==-<span class="number">1</span>:</span><br><span class="line">            valueX[i]=(-beta)*valueY[i] </span><br><span class="line">            opencashunbalance=-(valueY[i]+valueX[i])</span><br><span class="line">            openspread=SimSpreadT[i]</span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]+opencashunbalance</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line"><span class="comment">#             print(&#x27;%s 开仓：卖空 %.2f 元浦发银行股票，同时买入 %.2f元中国银行股票，现金账户增加 %.2f 元 &#x27;\</span></span><br><span class="line"><span class="comment">#                   % (SimSpreadT.index[i].strftime(&#x27;%Y-%m-%d&#x27;),-valueY[i],valueX[i],opencashunbalance))</span></span><br><span class="line">        <span class="keyword">elif</span> SimPosition[i-<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> SimPosition[i]==<span class="number">0</span>:</span><br><span class="line">            valueX[i]=<span class="number">0</span></span><br><span class="line">            closespread=SimSpreadT[i]</span><br><span class="line">            profit=valueY[i-<span class="number">1</span>]*(closespread-openspread)</span><br><span class="line">            tradeNum=tradeNum+<span class="number">1</span> <span class="comment">#平仓一次完成一次开平仓操作</span></span><br><span class="line">            <span class="keyword">if</span> profit&gt;<span class="number">0</span>:</span><br><span class="line">                winNum=winNum+<span class="number">1</span> <span class="comment"># 完成一次盈利开平仓操作</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]-opencashunbalance+profit</span><br><span class="line">            asset[i]=cash[i] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line"><span class="comment">#             print(&#x27;%s 平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;\</span></span><br><span class="line"><span class="comment">#                   % (SimSpreadT.index[i].strftime(&#x27;%Y-%m-%d&#x27;),profit,cash[i]))</span></span><br><span class="line">        <span class="keyword">elif</span> SimPosition[i-<span class="number">1</span>]==-<span class="number">1</span> <span class="keyword">and</span> SimPosition[i]==<span class="number">0</span>:</span><br><span class="line">            valueX[i]=<span class="number">0</span></span><br><span class="line">            closespread=SimSpreadT[i]</span><br><span class="line">            profit=valueY[i-<span class="number">1</span>]*(closespread-openspread)</span><br><span class="line">            tradeNum=tradeNum+<span class="number">1</span> <span class="comment">#平仓一次完成一次开平仓操作</span></span><br><span class="line">            <span class="keyword">if</span> profit&gt;<span class="number">0</span>:</span><br><span class="line">                winNum=winNum+<span class="number">1</span> <span class="comment"># 完成一次盈利开平仓操作</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]-opencashunbalance+profit</span><br><span class="line">            asset[i]=cash[i] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line"><span class="comment">#             print(&#x27;%s 平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;\</span></span><br><span class="line"><span class="comment">#                   % (SimSpreadT.index[i].strftime(&#x27;%Y-%m-%d&#x27;),profit,cash[i]))</span></span><br><span class="line">        <span class="keyword">elif</span> SimPosition[i-<span class="number">1</span>]==-<span class="number">1</span> <span class="keyword">and</span> SimPosition[i]==<span class="number">1</span>:</span><br><span class="line">            <span class="comment"># 先平仓 position: -1--&gt;0</span></span><br><span class="line">            closespread=SimSpreadT[i]</span><br><span class="line">            profit=valueY[i-<span class="number">1</span>]*(closespread-openspread)</span><br><span class="line">            tradeNum=tradeNum+<span class="number">1</span> <span class="comment">#平仓一次完成一次开平仓操作</span></span><br><span class="line">            <span class="keyword">if</span> profit&gt;<span class="number">0</span>:</span><br><span class="line">                winNum=winNum+<span class="number">1</span> <span class="comment"># 完成一次盈利开平仓操作</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]-opencashunbalance+profit</span><br><span class="line">            asset[i]=cash[i] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line"><span class="comment">#             print(&#x27;%s 平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;\</span></span><br><span class="line"><span class="comment">#                   % (SimSpreadT.index[i].strftime(&#x27;%Y-%m-%d&#x27;),profit,cash[i]))</span></span><br><span class="line">            <span class="comment"># 再反向开仓 position: 0--&gt;1</span></span><br><span class="line">            valueX[i]=(-beta)*valueY[i] </span><br><span class="line">            opencashunbalance=-(valueY[i]+valueX[i])</span><br><span class="line">            openspread=SimSpreadT[i]</span><br><span class="line">            cash[i]=cash[i]+opencashunbalance</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line"><span class="comment">#             print(&#x27;%s 开仓：买入 %.2f 元浦发银行股票，同时卖空 %.2f 元中国银行股票，现金账户增加 %.2f 元  &#x27;\</span></span><br><span class="line"><span class="comment">#                   % (SimSpreadT.index[i].strftime(&#x27;%Y-%m-%d&#x27;),valueY[i],-valueX[i],opencashunbalance))</span></span><br><span class="line">        <span class="keyword">elif</span> SimPosition[i-<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> SimPosition[i]==-<span class="number">1</span>:</span><br><span class="line">            <span class="comment"># 先平仓 position: 1--&gt;0</span></span><br><span class="line">            closespread=SimSpreadT[i]</span><br><span class="line">            profit=valueY[i-<span class="number">1</span>]*(closespread-openspread)</span><br><span class="line">            tradeNum=tradeNum+<span class="number">1</span> <span class="comment">#平仓一次完成一次开平仓操作</span></span><br><span class="line">            <span class="keyword">if</span> profit&gt;<span class="number">0</span>:</span><br><span class="line">                winNum=winNum+<span class="number">1</span> <span class="comment"># 完成一次盈利开平仓操作</span></span><br><span class="line">            cash[i]=cash[i-<span class="number">1</span>]-opencashunbalance+profit</span><br><span class="line">            asset[i]=cash[i] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line"><span class="comment">#             print(&#x27;%s 平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;\</span></span><br><span class="line"><span class="comment">#                   % (SimSpreadT.index[i].strftime(&#x27;%Y-%m-%d&#x27;),profit,cash[i]))</span></span><br><span class="line">            <span class="comment"># 再反向开仓 position: 0--&gt;-1</span></span><br><span class="line">            valueX[i]=(-beta)*valueY[i] </span><br><span class="line">            opencashunbalance=-(valueY[i]+valueX[i])</span><br><span class="line">            openspread=SimSpreadT[i]</span><br><span class="line">            cash[i]=cash[i]+opencashunbalance</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i-<span class="number">1</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[i])</span><br><span class="line"><span class="comment">#             print(&#x27;%s 开仓：卖空 %.2f 元浦发银行股票，同时买入 %.2f元中国银行股票，现金账户增加 %.2f 元 &#x27;\</span></span><br><span class="line"><span class="comment">#                   % (SimSpreadT.index[i].strftime(&#x27;%Y-%m-%d&#x27;),-valueY[i],valueX[i],opencashunbalance))</span></span><br><span class="line">    <span class="keyword">if</span> valueY[-<span class="number">1</span>]!=<span class="number">0</span>:<span class="comment"># 最后交易日仍有仓位，平仓</span></span><br><span class="line">        <span class="keyword">if</span> valueY[-<span class="number">2</span>]==<span class="number">0</span> :<span class="comment"># 最后交易日开仓，直接平仓（相当于最后交易日无操作）</span></span><br><span class="line">            closespread=SimSpreadT[-<span class="number">1</span>]</span><br><span class="line">            profit=<span class="number">0</span> <span class="comment"># 最后一日开仓又平仓不计入开平仓操作</span></span><br><span class="line">            cash[-<span class="number">1</span>]=cash[-<span class="number">1</span>]-opencashunbalance+profit</span><br><span class="line">            asset[-<span class="number">1</span>]=cash[-<span class="number">1</span>] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            valueY[-<span class="number">1</span>]=<span class="number">0</span> <span class="comment">#归0</span></span><br><span class="line">            valueX[-<span class="number">1</span>]=<span class="number">0</span> <span class="comment">#归0</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[-<span class="number">2</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[-<span class="number">1</span>])</span><br><span class="line"><span class="comment">#             print(&#x27;最后交易日 %s 开仓又平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;\</span></span><br><span class="line"><span class="comment">#                       % (SimSpreadT.index[i].strftime(&#x27;%Y-%m-%d&#x27;),profit,cash[i]))</span></span><br><span class="line">        <span class="keyword">else</span>:         </span><br><span class="line">            closespread=SimSpreadT[-<span class="number">1</span>]</span><br><span class="line">            profit=valueY[-<span class="number">2</span>]*(closespread-openspread)</span><br><span class="line">            tradeNum=tradeNum+<span class="number">1</span> <span class="comment">#平仓一次完成一次开平仓操作</span></span><br><span class="line">            <span class="keyword">if</span> profit&gt;<span class="number">0</span>:</span><br><span class="line">                winNum=winNum+<span class="number">1</span> <span class="comment"># 完成一次盈利开平仓操作</span></span><br><span class="line">            cash[-<span class="number">1</span>]=cash[-<span class="number">2</span>]-opencashunbalance+profit</span><br><span class="line">            asset[-<span class="number">1</span>]=cash[-<span class="number">1</span>] <span class="comment">#平仓后只有现金账户</span></span><br><span class="line">            TradeDate.append(SimSpreadT.index[-<span class="number">2</span>])</span><br><span class="line">            TradeDate.append(SimSpreadT.index[-<span class="number">1</span>])</span><br><span class="line"><span class="comment">#             print(&#x27;最后交易日 %s 平仓：获利  %.2f 元，现金账户和资金账户为  %.2f 元:  &#x27;\</span></span><br><span class="line"><span class="comment">#                       % (SimSpreadT.index[i].strftime(&#x27;%Y-%m-%d&#x27;),profit,cash[i]))</span></span><br><span class="line">        </span><br><span class="line">    cash = pd.Series(cash,index=SimPosition.index)</span><br><span class="line">    valueY=pd.Series(valueY,index=SimPosition.index)</span><br><span class="line">    valueX=pd.Series(valueX,index=SimPosition.index) </span><br><span class="line">    asset = pd.Series(asset,index=SimPosition.index)</span><br><span class="line">    account=pd.DataFrame(&#123;<span class="string">&#x27;Position&#x27;</span>:SimPosition,<span class="string">&#x27;ValueY&#x27;</span>:valueY,<span class="string">&#x27;ValueX&#x27;</span>:valueX,<span class="string">&#x27;Cash&#x27;</span>:cash,<span class="string">&#x27;Asset&#x27;</span>:asset,&#125;)</span><br><span class="line">    TradeDates=[] <span class="comment"># 删除列表TradeDate中重复的日期</span></span><br><span class="line">    <span class="keyword">for</span> date <span class="keyword">in</span> TradeDate:</span><br><span class="line">        <span class="keyword">if</span> date <span class="keyword">not</span> <span class="keyword">in</span> TradeDates:</span><br><span class="line">            TradeDates.append(date)</span><br><span class="line">    <span class="keyword">return</span>(account,TradeDates,tradeNum,winNum)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试模拟交易</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">starttime = time.time() <span class="comment"># 开始记录</span></span><br><span class="line">TrailNum=<span class="number">10000</span></span><br><span class="line">rets=[]</span><br><span class="line">tradeNums=[]</span><br><span class="line">winNums=[]</span><br><span class="line">winrates=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(TrailNum):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">1000</span>==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">    SimSpreadT=TradeSpreadSimulation(spreadf,model3,CoSpreadT)</span><br><span class="line">    SimSignal=TradeSig1(SimSpreadT) </span><br><span class="line">    SimPosition=TradePosition(SimSignal)</span><br><span class="line">    account,TradeDates,tradeNum,winNum=SimTradeCo2(SimSpreadT,SimPosition)</span><br><span class="line">    rets.append(account[<span class="string">&#x27;Asset&#x27;</span>][-<span class="number">1</span>]/account[<span class="string">&#x27;Asset&#x27;</span>][<span class="number">0</span>]-<span class="number">1</span>) <span class="comment"># 账户总收益率</span></span><br><span class="line">    tradeNums.append(tradeNum)</span><br><span class="line">    winNums.append(winNum)</span><br><span class="line">    <span class="keyword">if</span> tradeNum!=<span class="number">0</span>:</span><br><span class="line">        winrates.append(winNum/tradeNum)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        winrates.append(<span class="number">0</span>)</span><br><span class="line">endtime = time.time() <span class="comment"># 结束记录</span></span><br><span class="line">dtime = endtime - starttime</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;程序运行时间：%.1s s&quot;</span> % dtime)  <span class="comment"># 显示到微秒            </span></span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/71.png" alt="71"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 交易次数统计量</span></span><br><span class="line">np.mean(tradeNums), np.std(tradeNums), np.<span class="built_in">max</span>(tradeNums), np.<span class="built_in">min</span>(tradeNums)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/72.png" alt="72"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 胜率统计量</span></span><br><span class="line">np.mean(winrates), np.std(winrates), np.<span class="built_in">max</span>(winrates), np.<span class="built_in">min</span>(winrates)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/73.png" alt="73"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模拟交易收益率分布图</span></span><br><span class="line">rets=pd.Series(rets) </span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br><span class="line">nsample=<span class="number">10000</span></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">6</span>),dpi=<span class="number">80</span>)</span><br><span class="line">rn=stats.norm.fit(rets) </span><br><span class="line">n=stats.norm(loc=rn[<span class="number">0</span>],scale=rn[<span class="number">1</span>]) <span class="comment"># A normal continuous random variable</span></span><br><span class="line">n_rvs=np.linspace(n.ppf(<span class="number">.001</span>),n.ppf(<span class="number">.999</span>),nsample)  <span class="comment"># ppf: Percent point function (inverse of ``cdf`` --- percentiles)</span></span><br><span class="line">plt.plot(n_rvs,n.pdf(n_rvs),<span class="string">&#x27;r-&#x27;</span>,label=<span class="string">&#x27;normal&#x27;</span>)    <span class="comment"># pdf: Probability density function</span></span><br><span class="line">plt.hist(rets,bins=<span class="number">60</span>,density=<span class="literal">True</span>,label=<span class="string">&#x27;sample&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;收益率直方图&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">np.<span class="built_in">round</span>((rets.mean(), rets.std(),rets.skew(),rets.kurt()),<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/.io//../../../../../img/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/03/74.png" alt="74"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://wangzipeng1211.github.io/">Eddie</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://xxxxxx.com">https://xxxxxx.com</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">此文章版权归Quant 4ever所有，如有转载，请注明來自原作者</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/Quant/">Quant</a></div><div class="post_share"><div class="social-share" data-image="/img/cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechatpay.png" target="_blank"><img class="post-qr-code-img" src="/img/wechatpay.png" alt="Wechat"/></a><div class="post-qr-code-desc">Wechat</div></li><li class="reward-item"><a href="/img/alipay.png" target="_blank"><img class="post-qr-code-img" src="/img/alipay.png" alt="Alipay"/></a><div class="post-qr-code-desc">Alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/07/16/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E9%87%91%E8%9E%8D%E5%B7%A5%E7%A8%8B/%E6%9C%9F%E6%9D%83%E6%9C%9F%E8%B4%A7%E5%8F%8A%E5%85%B6%E4%BB%96%E8%A1%8D%E7%94%9F%E5%93%81/Notebook/1%E5%AF%BC%E8%AE%BA/"><img class="prev-cover" src="/img/cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">期权、期货及其他衍生品</div></div></a></div><div class="next-post pull-right"><a href="/2023/07/11/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/02_3/"><img class="next-cover" src="/img/cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">算法交易和量化投资02(续2)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/07/09/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/02_2/" title="算法交易和量化投资02(续1)"><img class="cover" src="/img/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-09</div><div class="title">算法交易和量化投资02(续1)</div></div></a></div><div><a href="/2022/09/21/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/02_1/" title="算法交易和量化投资02"><img class="cover" src="/img/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-21</div><div class="title">算法交易和量化投资02</div></div></a></div><div><a href="/2023/07/11/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/02_3/" title="算法交易和量化投资02(续2)"><img class="cover" src="/img/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-11</div><div class="title">算法交易和量化投资02(续2)</div></div></a></div><div><a href="/2023/07/20/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/%E7%AE%97%E6%B3%95%E4%BA%A4%E6%98%93%E5%92%8C%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/Notebook/04/" title="算法交易和量化投资04"><img class="cover" src="/img/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-20</div><div class="title">算法交易和量化投资04</div></div></a></div><div><a href="/2023/08/30/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/Python%20and%20Statistics%20for%20Financial%20Analysis/Week1/Note/" title="Python and Statistics for Financial Analysis Week1"><img class="cover" src="/img/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-30</div><div class="title">Python and Statistics for Financial Analysis Week1</div></div></a></div><div><a href="/2023/09/01/%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93/Python%20and%20Statistics%20for%20Financial%20Analysis/Week2/Note/" title="Python and Statistics for Financial Analysis Week2"><img class="cover" src="/img/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-01</div><div class="title">Python and Statistics for Financial Analysis Week2</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E5%AF%B9%E4%BA%A4%E6%98%93%E6%A6%82%E5%BF%B5"><span class="toc-text"> 配对交易概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E5%AF%B9%E4%BA%A4%E6%98%93%E7%AD%96%E7%95%A5"><span class="toc-text"> 配对交易策略</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%82%A1%E7%A5%A8%E5%AF%B9%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-text"> 股票对的选择</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%E6%B3%95%E7%AC%AC%E4%B8%80%E6%AD%A5-%E9%80%9A%E8%BF%87%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%E6%B3%95%E6%8C%91%E9%80%89%E8%82%A1%E7%A5%A8%E5%AF%B9"><span class="toc-text"> 最小距离法：第一步 通过最小距离法挑选股票对</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E8%B7%9D%E7%A6%BB%E6%B3%95%E7%AC%AC%E4%BA%8C%E6%AD%A5-%E8%AE%BE%E5%AE%9A%E4%BA%A4%E6%98%93%E8%A7%84%E5%88%99"><span class="toc-text"> 最小距离法：第二步 设定交易规则</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E5%AF%B9%E4%BA%A4%E6%98%93%E7%9A%84%E6%BD%9C%E5%9C%A8%E6%94%B6%E7%9B%8A%E4%B8%8E%E9%A3%8E%E9%99%A9"><span class="toc-text"> 配对交易的潜在收益与风险</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%8F%E6%95%B4"><span class="toc-text"> 协整</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0"><span class="toc-text"> 自相关系数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0%E7%9A%84%E7%BB%9F%E8%AE%A1%E6%A3%80%E9%AA%8C"><span class="toc-text"> 自相关系数的统计检验</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#stattoolsacf"><span class="toc-text"> stattools.acf?</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#parameters"><span class="toc-text"> Parameters</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#returns"><span class="toc-text"> Returns</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B9%B3%E7%A8%B3%E6%80%A7%E5%BA%8F%E5%88%97"><span class="toc-text"> 平稳性序列</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B9%B3%E7%A8%B3%E6%80%A7%E6%A3%80%E9%AA%8C-%E5%8D%95%E4%BD%8D%E6%A0%B9%E6%A3%80%E9%AA%8C"><span class="toc-text"> 平稳性检验 -  单位根检验</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%99%BD%E5%99%AA%E5%A3%B0%E5%BA%8F%E5%88%97"><span class="toc-text"> 白噪声序列</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%99%BD%E5%99%AA%E5%A3%B0%E6%A3%80%E9%AA%8C"><span class="toc-text"> 白噪声检验</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#stattoolsq_stat"><span class="toc-text"> stattools.q_stat?</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#parameters-2"><span class="toc-text"> Parameters</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#returns-2"><span class="toc-text"> Returns</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E5%AF%B9%E4%BA%A4%E6%98%93%E7%9A%84%E5%8D%8F%E6%95%B4%E6%A8%A1%E5%9E%8B%E4%B8%80-%E5%8D%8F%E6%95%B4%E5%85%B3%E7%B3%BB%E6%A3%80%E9%AA%8C"><span class="toc-text"> 配对交易的协整模型：一、协整关系检验</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E5%AF%B9%E4%BA%A4%E6%98%93%E7%9A%84%E5%8D%8F%E6%95%B4%E6%A8%A1%E5%9E%8B%E4%BA%8C-%E8%AE%BE%E5%AE%9A%E4%BA%A4%E6%98%93%E8%A7%84%E5%88%99"><span class="toc-text"> 配对交易的协整模型：二、设定交易规则</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E4%BB%B7%E5%B7%AE%E6%B3%95"><span class="toc-text"> 随机价差法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E7%9A%84%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-text"> 时间序列的预处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%88%A4%E6%96%AD%E5%BA%8F%E5%88%97%E6%98%AF%E5%90%A6%E4%B8%BA%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97adf%E6%A3%80%E9%AA%8C%E5%A6%82%E6%9E%9C%E4%B8%BA%E9%9D%9E%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97%E8%BF%9B%E8%A1%8C%E5%8F%98%E6%8D%A2%E8%BD%AC%E5%8C%96%E4%B8%BA%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97"><span class="toc-text"> 1. 判断序列是否为平稳序列（ADF检验），如果为非平稳序列，进行变换转化为平稳序列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%A6%82%E6%9E%9C%E5%BA%8F%E5%88%97%E4%B8%BA%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97%E6%A3%80%E9%AA%8C%E6%98%AF%E5%90%A6%E4%B8%BA%E7%99%BD%E5%99%AA%E5%A3%B0%E5%BA%8F%E5%88%97ljung-box%E6%A3%80%E9%AA%8C%E6%A3%80%E9%AA%8C%E5%BA%8F%E5%88%97%E7%9A%84%E5%90%84%E9%A1%B9%E4%B9%8B%E9%97%B4%E6%9C%89%E6%B2%A1%E6%9C%89%E8%87%AA%E7%9B%B8%E5%85%B3%E6%80%A7%E5%A6%82%E6%9E%9C%E4%B8%BA%E7%99%BD%E5%99%AA%E9%9F%B3%E5%8F%AF%E4%BB%A5%E7%BB%88%E6%AD%A2%E5%AF%B9%E8%AF%A5%E5%BA%8F%E5%88%97%E7%9A%84%E5%88%86%E6%9E%90-%E7%99%BD%E5%99%AA%E5%A3%B0%E5%BA%8F%E5%88%97%E6%98%AF%E6%B2%A1%E6%9C%89%E4%BF%A1%E6%81%AF%E5%8F%AF%E6%8F%90%E5%8F%96%E7%9A%84%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97"><span class="toc-text"> 2. 如果序列为平稳序列，检验是否为白噪声序列(Ljung-Box检验，检验序列的各项之间有没有自相关性)，如果为白噪音，可以终止对该序列的分析。白噪声序列是没有信息可提取的平稳序列。</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%A6%82%E6%9E%9C%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97%E4%B8%BA%E9%9D%9E%E7%99%BD%E5%99%AA%E5%A3%B0%E5%BA%8F%E5%88%97%E5%8F%AF%E4%BB%A5%E8%80%83%E8%99%91%E5%BB%BA%E7%AB%8Barmapq%E6%A8%A1%E5%9E%8Baic%E6%88%96%E8%80%85bic%E6%A0%87%E5%87%86%E9%80%89%E5%8F%96pq"><span class="toc-text"> 3. 如果平稳序列为非白噪声序列，可以考虑建立ARMA(p,q)模型(AIC或者BIC标准选取p,q)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="toc-text"> 时间序列分析流程图</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8Bautoregressive-model-ar%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 自回归模型（Autoregressive Model, AR模型）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E5%B9%B3%E5%9D%87%E6%A8%A1%E5%9E%8Bmoving-average-ma%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 移动平均模型（Moving-Average, MA模型）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%9B%9E%E5%BD%92%E7%A7%BB%E5%8A%A8%E5%B9%B3%E5%9D%87%E6%A8%A1%E5%9E%8Bautoregressive-moving-average-arma%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 自回归移动平均模型（Autoregressive Moving-Average, ARMA模型）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%9B%9E%E5%BD%92%E6%9D%A1%E4%BB%B6%E5%BC%82%E6%96%B9%E5%B7%AE%E6%A8%A1%E5%9E%8B-autoregressive-conditional-heteroskedasticity-arch%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 自回归条件异方差模型 - Autoregressive conditional heteroskedasticity, ARCH模型</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#arch%E6%A8%A1%E5%9E%8B"><span class="toc-text"> ARCH模型</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B9%BF%E4%B9%89%E8%87%AA%E5%9B%9E%E5%BD%92%E6%9D%A1%E4%BB%B6%E5%BC%82%E6%96%B9%E5%B7%AE%E6%A8%A1%E5%9E%8B-garchmn"><span class="toc-text"> 广义自回归条件异方差模型 - GARCH（m，n）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E4%BB%B7%E5%B7%AE%E5%BA%8F%E5%88%97%E7%9A%84%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%BB%BA%E6%A8%A1%E6%A8%A1%E6%8B%9F%E5%8D%8F%E6%95%B4%E9%85%8D%E5%AF%B9%E4%BA%A4%E6%98%93%E7%AD%96%E5%88%97%E7%9A%84%E6%94%B6%E7%9B%8A%E4%B8%8E%E9%A3%8E%E9%99%A9"><span class="toc-text"> 基于价差序列的时间序列建模模拟协整配对交易策列的收益与风险</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%E4%BB%B7%E5%B7%AE%E5%BA%8F%E5%88%97%E7%9A%84%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%BB%BA%E6%A8%A1"><span class="toc-text"> 第一步：价差序列的时间序列建模</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%E6%A8%A1%E5%9E%8B%E4%BA%A4%E6%98%93%E6%9C%9F%E9%85%8D%E5%AF%B9%E4%BB%B7%E6%A0%BC%E5%BA%8F%E5%88%97%E5%B9%B6%E8%AE%A1%E7%AE%97%E5%8D%8F%E6%95%B4%E9%85%8D%E5%AF%B9%E4%BA%A4%E6%98%93%E7%9A%84%E6%94%B6%E7%9B%8A%E4%B8%8E%E9%A3%8E%E9%99%A9"><span class="toc-text"> 第二步：模型交易期配对价格序列，并计算协整配对交易的收益与风险</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By Eddie</div><div class="footer_custom_text">梧高凤必至, 花香蝶自来</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>